--[[
  AnimeRangersX Script Loader
  Được mã hóa bởi: Dương Tuấn và ghjiukliop
  
  Người chơi được phép sử dụng script này cho mục đích cá nhân
  Nghiêm cấm chia sẻ, bán lại hoặc chỉnh sửa mà không được phép!
]]

local HT_Hub = {}
HT_Hub.Version = "1.0"
HT_Hub.LastUpdate = "2023"

-- Functions
local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
local function dec(data)
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
        if (#x ~= 8) then return '' end
        local c=0
        for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end

-- Anti-Debug Protection
local env = getfenv()
local old_info = debug.info
debug.info = function(...)
    local info = old_info(...)
    if info and info:find("AnimeRangersX") then
        return "function: 0x" .. string.format("%x", math.random(1000000, 9999999))
    end
    return info
end

-- Extra Security
local function securityCheck()
    local plr = game:GetService("Players").LocalPlayer
    if not plr then return true end
    
    local banned = {
        -- Thêm HWID hoặc UserID của người dùng bị cấm vào đây
    }
    
    for _, id in ipairs(banned) do
        if tostring(plr.UserId) == tostring(id) then
            return false
        end
    end
    
    return true
end

-- Check Executor
local supported = {
    "Krnl",
    "Fluxus", 
    "Codex", 
    "Delta", 
    "Synapse", 
    "ScriptWare",
    "Electron"
}

local function isExecutorSupported()
    local execIdentify = identifyexecutor or getexecutorname
    if not execIdentify then return true end
    
    local executor = execIdentify()
    if not executor then return true end
    
    for _, name in ipairs(supported) do
        if executor:lower():find(name:lower()) then
            return true
        end
    end
    
    return false
end

-- Mã hóa script (dán mã đã mã hóa ở đây)
local encryptedScript = [[
LS0gQW5pbWUgUmFuZ2VycyBYIFNjcmlwdAoKLS0gVOG6o2kgdGjGsCB2aeG7h24gRmx1ZW50IHThu6sgQXJpc2UKbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgRmx1ZW50ID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vZ2l0aHViLmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9yZWxlYXNlcy9sYXRlc3QvZG93bmxvYWQvbWFpbi5sdWEiKSkoKQogICAgU2F2ZU1hbmFnZXIgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2Rhd2lkLXNjcmlwdHMvRmx1ZW50L21hc3Rlci9BZGRvbnMvU2F2ZU1hbmFnZXIubHVhIikpKCkKICAgIEludGVyZmFjZU1hbmFnZXIgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2Rhd2lkLXNjcmlwdHMvRmx1ZW50L21hc3Rlci9BZGRvbnMvSW50ZXJmYWNlTWFuYWdlci5sdWEiKSkoKQplbmQpCgppZiBub3Qgc3VjY2VzcyB0aGVuCiAgICB3YXJuKCJM4buXaSBraGkgdOG6o2kgdGjGsCB2aeG7h24gRmx1ZW50OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICAtLSBUaOG7rSB04bqjaSB04burIFVSTCBk4buxIHBow7JuZwogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIEZsdWVudCA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvbWFzdGVyL0ZsdWVudC5sdWEiKSkoKQogICAgICAgIFNhdmVNYW5hZ2VyID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9kYXdpZC1zY3JpcHRzL0ZsdWVudC9tYXN0ZXIvQWRkb25zL1NhdmVNYW5hZ2VyLmx1YSIpKSgpCiAgICAgICAgSW50ZXJmYWNlTWFuYWdlciA9IGxvYWRzdHJpbmcoZ2FtZTpIdHRwR2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZGF3aWQtc2NyaXB0cy9GbHVlbnQvbWFzdGVyL0FkZG9ucy9JbnRlcmZhY2VNYW5hZ2VyLmx1YSIpKSgpCiAgICBlbmQpCmVuZAoKaWYgbm90IEZsdWVudCB0aGVuCiAgICBlcnJvcigiS2jDtG5nIHRo4buDIHThuqNpIHRoxrAgdmnhu4duIEZsdWVudC4gVnVpIGzDsm5nIGtp4buDbSB0cmEga+G6v3QgbuG7kWkgaW50ZXJuZXQgaG/hurdjIGV4ZWN1dG9yLiIpCiAgICByZXR1cm4KZW5kCgotLSBVdGlsaXR5IGZ1bmN0aW9uIMSR4buDIGtp4buDbSB0cmEgdsOgIGzhuqV5IHNlcnZpY2Uvb2JqZWN0IG3hu5l0IGPDoWNoIGFuIHRvw6BuCmxvY2FsIGZ1bmN0aW9uIHNhZmVHZXRTZXJ2aWNlKHNlcnZpY2VOYW1lKQogICAgbG9jYWwgc2VydmljZSA9IG5pbAogICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIHNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2Uoc2VydmljZU5hbWUpCiAgICBlbmQpCiAgICByZXR1cm4gc2VydmljZQplbmQKCi0tIFV0aWxpdHkgZnVuY3Rpb24gxJHhu4Mga2nhu4NtIHRyYSB2w6AgbOG6pXkgY2hpbGQgbeG7mXQgY8OhY2ggYW4gdG/DoG4KbG9jYWwgZnVuY3Rpb24gc2FmZUdldENoaWxkKHBhcmVudCwgY2hpbGROYW1lLCB3YWl0VGltZSkKICAgIGlmIG5vdCBwYXJlbnQgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgCiAgICBsb2NhbCBjaGlsZCA9IG5pbAogICAgd2FpdFRpbWUgPSB3YWl0VGltZSBvciAxCiAgICAKICAgIGxvY2FsIHN1Y2Nlc3MgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgY2hpbGQgPSBwYXJlbnQ6RmluZEZpcnN0Q2hpbGQoY2hpbGROYW1lKQogICAgICAgIGlmIG5vdCBjaGlsZCBhbmQgd2FpdFRpbWUgPiAwIHRoZW4KICAgICAgICAgICAgY2hpbGQgPSBwYXJlbnQ6V2FpdEZvckNoaWxkKGNoaWxkTmFtZSwgd2FpdFRpbWUpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBjaGlsZAplbmQKCi0tIFV0aWxpdHkgZnVuY3Rpb24gxJHhu4MgbOG6pXkgxJHGsOG7nW5nIGThuqtuIMSR4bqneSDEkeG7pyBt4buZdCBjw6FjaCBhbiB0b8Ogbgpsb2NhbCBmdW5jdGlvbiBzYWZlR2V0UGF0aChzdGFydFBvaW50LCBwYXRoLCB3YWl0VGltZSkKICAgIHdhaXRUaW1lID0gd2FpdFRpbWUgb3IgMQogICAgbG9jYWwgY3VycmVudCA9IHN0YXJ0UG9pbnQKICAgIAogICAgZm9yIF8sIG5hbWUgaW4gaXBhaXJzKHBhdGgpIGRvCiAgICAgICAgaWYgbm90IGN1cnJlbnQgdGhlbiByZXR1cm4gbmlsIGVuZAogICAgICAgIGN1cnJlbnQgPSBzYWZlR2V0Q2hpbGQoY3VycmVudCwgbmFtZSwgd2FpdFRpbWUpCiAgICBlbmQKICAgIAogICAgcmV0dXJuIGN1cnJlbnQKZW5kCgotLSBI4buHIHRo4buRbmcgbMawdSB0cuG7ryBj4bqldSBow6xuaApsb2NhbCBDb25maWdTeXN0ZW0gPSB7fQpDb25maWdTeXN0ZW0uRmlsZU5hbWUgPSAiSFRIdWJBUkNvbmZpZ18iIC4uIGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpLkxvY2FsUGxheWVyLk5hbWUgLi4gIi5qc29uIgpDb25maWdTeXN0ZW0uRGVmYXVsdENvbmZpZyA9IHsKICAgIC0tIEPDoWMgY8OgaSDEkeG6t3QgbeG6t2MgxJHhu4tuaAogICAgVUlUaGVtZSA9ICJBbWV0aHlzdCIsCiAgICAKICAgIC0tIEPDoGkgxJHhurd0IFNob3AvU3VtbW9uCiAgICBTdW1tb25BbW91bnQgPSAieDEiLAogICAgU3VtbW9uQmFubmVyID0gIlN0YW5kYXJkIiwKICAgIEF1dG9TdW1tb24gPSBmYWxzZSwKICAgIAogICAgLS0gQ8OgaSDEkeG6t3QgUXVlc3QKICAgIEF1dG9DbGFpbVF1ZXN0ID0gZmFsc2UsCiAgICAKICAgIC0tIEPDoGkgxJHhurd0IFN0b3J5CiAgICBTZWxlY3RlZE1hcCA9ICJPbmVQaWVjZSIsCiAgICBTZWxlY3RlZENoYXB0ZXIgPSAiQ2hhcHRlcjEiLAogICAgU2VsZWN0ZWREaWZmaWN1bHR5ID0gIk5vcm1hbCIsCiAgICBGcmllbmRPbmx5ID0gZmFsc2UsCiAgICBBdXRvSm9pbk1hcCA9IGZhbHNlLAogICAgU3RvcnlUaW1lRGVsYXkgPSA1LAogICAgCiAgICAtLSBDw6BpIMSR4bq3dCBSYW5nZXIgU3RhZ2UKICAgIFNlbGVjdGVkUmFuZ2VyTWFwID0gIk9uZVBpZWNlIiwKICAgIFNlbGVjdGVkQWN0ID0gIlJhbmdlclN0YWdlMSIsCiAgICBSYW5nZXJGcmllbmRPbmx5ID0gZmFsc2UsCiAgICBBdXRvSm9pblJhbmdlciA9IGZhbHNlLAogICAgUmFuZ2VyVGltZURlbGF5ID0gNSwKICAgIAogICAgLS0gQ8OgaSDEkeG6t3QgQm9zcyBFdmVudAogICAgQXV0b0Jvc3NFdmVudCA9IGZhbHNlLAogICAgQm9zc0V2ZW50VGltZURlbGF5ID0gNSwKICAgIAogICAgLS0gQ8OgaSDEkeG6t3QgSW4tR2FtZQogICAgQXV0b1BsYXkgPSBmYWxzZSwKICAgIEF1dG9SZXRyeSA9IGZhbHNlLAogICAgQXV0b05leHQgPSBmYWxzZSwKICAgIEF1dG9Wb3RlID0gZmFsc2UsCiAgICAKICAgIC0tIEPDoGkgxJHhurd0IFVwZGF0ZSBVbml0cwogICAgQXV0b1VwZGF0ZSA9IGZhbHNlLAogICAgQXV0b1VwZGF0ZVJhbmRvbSA9IGZhbHNlLAogICAgU2xvdDFMZXZlbCA9IDAsCiAgICBTbG90MkxldmVsID0gMCwKICAgIFNsb3QzTGV2ZWwgPSAwLAogICAgU2xvdDRMZXZlbCA9IDAsCiAgICBTbG90NUxldmVsID0gMCwKICAgIFNsb3Q2TGV2ZWwgPSAwLAogICAgCiAgICAtLSBDw6BpIMSR4bq3dCBBRksKICAgIEF1dG9Kb2luQUZLID0gZmFsc2UKfQpDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZyA9IHt9CgotLSBIw6BtIMSR4buDIGzGsHUgY+G6pXUgaMOsbmgKQ29uZmlnU3lzdGVtLlNhdmVDb25maWcgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgd3JpdGVmaWxlKENvbmZpZ1N5c3RlbS5GaWxlTmFtZSwgZ2FtZTpHZXRTZXJ2aWNlKCJIdHRwU2VydmljZSIpOkpTT05FbmNvZGUoQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcpKQogICAgZW5kKQogICAgCiAgICBpZiBzdWNjZXNzIHRoZW4KICAgICAgICBwcmludCgixJDDoyBsxrB1IGPhuqV1IGjDrG5oIHRow6BuaCBjw7RuZyEiKQogICAgZWxzZQogICAgICAgIHdhcm4oIkzGsHUgY+G6pXUgaMOsbmggdGjhuqV0IGLhuqFpOiIsIGVycikKICAgIGVuZAplbmQKCi0tIEjDoG0gxJHhu4MgdOG6o2kgY+G6pXUgaMOsbmgKQ29uZmlnU3lzdGVtLkxvYWRDb25maWcgPSBmdW5jdGlvbigpCiAgICBsb2NhbCBzdWNjZXNzLCBjb250ZW50ID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGlmIGlzZmlsZShDb25maWdTeXN0ZW0uRmlsZU5hbWUpIHRoZW4KICAgICAgICAgICAgcmV0dXJuIHJlYWRmaWxlKENvbmZpZ1N5c3RlbS5GaWxlTmFtZSkKICAgICAgICBlbmQKICAgICAgICByZXR1cm4gbmlsCiAgICBlbmQpCiAgICAKICAgIGlmIHN1Y2Nlc3MgYW5kIGNvbnRlbnQgdGhlbgogICAgICAgIGxvY2FsIGRhdGEgPSBnYW1lOkdldFNlcnZpY2UoIkh0dHBTZXJ2aWNlIik6SlNPTkRlY29kZShjb250ZW50KQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnID0gZGF0YQogICAgICAgIHJldHVybiB0cnVlCiAgICBlbHNlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcgPSB0YWJsZS5jbG9uZShDb25maWdTeXN0ZW0uRGVmYXVsdENvbmZpZykKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKZW5kCgotLSBU4bqjaSBj4bqldSBow6xuaCBraGkga2jhu59pIMSR4buZbmcKQ29uZmlnU3lzdGVtLkxvYWRDb25maWcoKQoKLS0gQmnhur9uIHRvw6BuIGPhu6VjIMSR4buDIHRoZW8gZMO1aSBVSQpsb2NhbCBPcGVuVUkgPSBuaWwKbG9jYWwgaXNNaW5pbWl6ZWQgPSBmYWxzZQoKLS0gQmnhur9uIGzGsHUgdHLhuqFuZyB0aMOhaSBTdW1tb24KbG9jYWwgc2VsZWN0ZWRTdW1tb25BbW91bnQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TdW1tb25BbW91bnQgb3IgIngxIgpsb2NhbCBzZWxlY3RlZFN1bW1vbkJhbm5lciA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlN1bW1vbkJhbm5lciBvciAiU3RhbmRhcmQiCmxvY2FsIGF1dG9TdW1tb25FbmFibGVkID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1N1bW1vbiBvciBmYWxzZQpsb2NhbCBhdXRvU3VtbW9uTG9vcCA9IG5pbAoKLS0gQmnhur9uIGzGsHUgdHLhuqFuZyB0aMOhaSBRdWVzdApsb2NhbCBhdXRvQ2xhaW1RdWVzdEVuYWJsZWQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvQ2xhaW1RdWVzdCBvciBmYWxzZQpsb2NhbCBhdXRvQ2xhaW1RdWVzdExvb3AgPSBuaWwKCi0tIE1hcHBpbmcgZ2nhu69hIHTDqm4gaGnhu4NuIHRo4buLIHbDoCB0w6puIHRo4bqtdCBj4bunYSBtYXAKbG9jYWwgbWFwTmFtZU1hcHBpbmcgPSB7CiAgICBbIlZvb2NoYSBWaWxsYWdlIl0gPSAiT25lUGllY2UiLAogICAgWyJHcmVlbiBQbGFuZXQiXSA9ICJOYW1layIsCiAgICBbIkRlbW9uIEZvcmVzdCJdID0gIkRlbW9uU2xheWVyIiwKICAgIFsiTGVhZiBWaWxsYWdlIl0gPSAiTmFydXRvIiwKICAgIFsiWiBDaXR5Il0gPSAiT1BNIgp9CgotLSBNYXBwaW5nIG5nxrDhu6NjIGzhuqFpIMSR4buDIGhp4buDbiB0aOG7iyB0w6puIGNobyBuZ8aw4budaSBkw7luZwpsb2NhbCByZXZlcnNlTWFwTmFtZU1hcHBpbmcgPSB7fQpmb3IgZGlzcGxheSwgcmVhbCBpbiBwYWlycyhtYXBOYW1lTWFwcGluZykgZG8KICAgIHJldmVyc2VNYXBOYW1lTWFwcGluZ1tyZWFsXSA9IGRpc3BsYXkKZW5kCgotLSBCaeG6v24gbMawdSB0cuG6oW5nIHRow6FpIFN0b3J5CmxvY2FsIHNlbGVjdGVkTWFwID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2VsZWN0ZWRNYXAgb3IgIk9uZVBpZWNlIgpsb2NhbCBzZWxlY3RlZERpc3BsYXlNYXAgPSByZXZlcnNlTWFwTmFtZU1hcHBpbmdbc2VsZWN0ZWRNYXBdIG9yICJWb29jaGEgVmlsbGFnZSIKbG9jYWwgc2VsZWN0ZWRDaGFwdGVyID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2VsZWN0ZWRDaGFwdGVyIG9yICJDaGFwdGVyMSIKbG9jYWwgc2VsZWN0ZWREaWZmaWN1bHR5ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2VsZWN0ZWREaWZmaWN1bHR5IG9yICJOb3JtYWwiCmxvY2FsIGZyaWVuZE9ubHkgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5GcmllbmRPbmx5IG9yIGZhbHNlCmxvY2FsIGF1dG9Kb2luTWFwRW5hYmxlZCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9Kb2luTWFwIG9yIGZhbHNlCmxvY2FsIGF1dG9Kb2luTWFwTG9vcCA9IG5pbAoKLS0gQmnhur9uIGzGsHUgdHLhuqFuZyB0aMOhaSBSYW5nZXIgU3RhZ2UKbG9jYWwgc2VsZWN0ZWRSYW5nZXJNYXAgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TZWxlY3RlZFJhbmdlck1hcCBvciAiT25lUGllY2UiCmxvY2FsIHNlbGVjdGVkUmFuZ2VyRGlzcGxheU1hcCA9IHJldmVyc2VNYXBOYW1lTWFwcGluZ1tzZWxlY3RlZFJhbmdlck1hcF0gb3IgIlZvb2NoYSBWaWxsYWdlIgpsb2NhbCBzZWxlY3RlZEFjdCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlNlbGVjdGVkQWN0IG9yICJSYW5nZXJTdGFnZTEiCmxvY2FsIHJhbmdlckZyaWVuZE9ubHkgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5SYW5nZXJGcmllbmRPbmx5IG9yIGZhbHNlCmxvY2FsIGF1dG9Kb2luUmFuZ2VyRW5hYmxlZCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9Kb2luUmFuZ2VyIG9yIGZhbHNlCmxvY2FsIGF1dG9Kb2luUmFuZ2VyTG9vcCA9IG5pbAoKLS0gQmnhur9uIGzGsHUgdHLhuqFuZyB0aMOhaSBCb3NzIEV2ZW50CmxvY2FsIGF1dG9Cb3NzRXZlbnRFbmFibGVkID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0Jvc3NFdmVudCBvciBmYWxzZQpsb2NhbCBhdXRvQm9zc0V2ZW50TG9vcCA9IG5pbAoKLS0gQmnhur9uIGzGsHUgdHLhuqFuZyB0aMOhaSBJbi1HYW1lCmxvY2FsIGF1dG9QbGF5RW5hYmxlZCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9QbGF5IG9yIGZhbHNlCmxvY2FsIGF1dG9SZXRyeUVuYWJsZWQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvUmV0cnkgb3IgZmFsc2UKbG9jYWwgYXV0b05leHRFbmFibGVkID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b05leHQgb3IgZmFsc2UKbG9jYWwgYXV0b1ZvdGVFbmFibGVkID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1ZvdGUgb3IgZmFsc2UKbG9jYWwgYXV0b1JldHJ5TG9vcCA9IG5pbApsb2NhbCBhdXRvTmV4dExvb3AgPSBuaWwKbG9jYWwgYXV0b1ZvdGVMb29wID0gbmlsCgotLSBCaeG6v24gbMawdSB0cuG6oW5nIHRow6FpIFVwZGF0ZSBVbml0cwpsb2NhbCBhdXRvVXBkYXRlRW5hYmxlZCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9VcGRhdGUgb3IgZmFsc2UKbG9jYWwgYXV0b1VwZGF0ZVJhbmRvbUVuYWJsZWQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvVXBkYXRlUmFuZG9tIG9yIGZhbHNlCmxvY2FsIGF1dG9VcGRhdGVMb29wID0gbmlsCmxvY2FsIGF1dG9VcGRhdGVSYW5kb21Mb29wID0gbmlsCmxvY2FsIHVuaXRTbG90TGV2ZWxzID0gewogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDFMZXZlbCBvciAwLAogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDJMZXZlbCBvciAwLAogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDNMZXZlbCBvciAwLAogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDRMZXZlbCBvciAwLAogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDVMZXZlbCBvciAwLAogICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2xvdDZMZXZlbCBvciAwCn0KbG9jYWwgdW5pdFNsb3RzID0ge30KCi0tIEJp4bq/biBsxrB1IHRy4bqhbmcgdGjDoWkgVGltZSBEZWxheQpsb2NhbCBzdG9yeVRpbWVEZWxheSA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlN0b3J5VGltZURlbGF5IG9yIDUKbG9jYWwgcmFuZ2VyVGltZURlbGF5ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuUmFuZ2VyVGltZURlbGF5IG9yIDUKbG9jYWwgYm9zc0V2ZW50VGltZURlbGF5ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQm9zc0V2ZW50VGltZURlbGF5IG9yIDUKCi0tIEJp4bq/biBsxrB1IHRy4bqhbmcgdGjDoWkgQUZLCmxvY2FsIGF1dG9Kb2luQUZLRW5hYmxlZCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9Kb2luQUZLIG9yIGZhbHNlCmxvY2FsIGF1dG9Kb2luQUZLTG9vcCA9IG5pbAoKLS0gVGjDtG5nIHRpbiBuZ8aw4budaSBjaMahaQpsb2NhbCBwbGF5ZXJOYW1lID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIuTmFtZQoKLS0gVOG6oW8gV2luZG93CmxvY2FsIFdpbmRvdyA9IEZsdWVudDpDcmVhdGVXaW5kb3coewogICAgVGl0bGUgPSAiSFQgSHViIHwgQW5pbWUgUmFuZ2VycyBYIiwKICAgIFN1YlRpdGxlID0gIiIsCiAgICBUYWJXaWR0aCA9IDE2MCwKICAgIFNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDU4MCwgNDYwKSwKICAgIEFjcnlsaWMgPSB0cnVlLAogICAgVGhlbWUgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5VSVRoZW1lIG9yICJEYXJrIiwKICAgIE1pbmltaXplS2V5ID0gRW51bS5LZXlDb2RlLkxlZnRDb250cm9sCn0pCgotLSBU4bqhbyB0YWIgSW5mbwpsb2NhbCBJbmZvVGFiID0gV2luZG93OkFkZFRhYih7CiAgICBUaXRsZSA9ICJJbmZvIiwKICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzc3MzM5NjQ3MTkiCn0pCgotLSBU4bqhbyB0YWIgUGxheQpsb2NhbCBQbGF5VGFiID0gV2luZG93OkFkZFRhYih7CiAgICBUaXRsZSA9ICJQbGF5IiwKICAgIEljb24gPSAicmJ4YXNzZXRpZDovLzc3NDM4NzE0ODAiCn0pCgotLSBU4bqhbyB0YWIgSW4tR2FtZQpsb2NhbCBJbkdhbWVUYWIgPSBXaW5kb3c6QWRkVGFiKHsKICAgIFRpdGxlID0gIkluLUdhbWUiLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczMzc5OTkwMSIKfSkKCi0tIFThuqFvIHRhYiBTaG9wCmxvY2FsIFNob3BUYWIgPSBXaW5kb3c6QWRkVGFiKHsKICAgIFRpdGxlID0gIlNob3AiLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNzczNDA1Njc0NyIKfSkKCi0tIFThuqFvIHRhYiBTZXR0aW5ncwpsb2NhbCBTZXR0aW5nc1RhYiA9IFdpbmRvdzpBZGRUYWIoewogICAgVGl0bGUgPSAiU2V0dGluZ3MiLAogICAgSWNvbiA9ICJyYnhhc3NldGlkOi8vNjAzMTI4MDg4MiIKfSkKCi0tIFThuqFvIGxvZ28gVUkgxJHhu4MgbeG7nyBs4bqhaSBraGkgxJHDoyB0aHUgbmjhu48KbG9jYWwgZnVuY3Rpb24gQ3JlYXRlTG9nb1VJKCkKICAgIGxvY2FsIFVJID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgbG9jYWwgQnV0dG9uID0gSW5zdGFuY2UubmV3KCJJbWFnZUJ1dHRvbiIpCiAgICBsb2NhbCBVSUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgCiAgICAtLSBLaeG7g20gdHJhIG3DtGkgdHLGsOG7nW5nCiAgICBpZiBzeW4gYW5kIHN5bi5wcm90ZWN0X2d1aSB0aGVuCiAgICAgICAgc3luLnByb3RlY3RfZ3VpKFVJKQogICAgICAgIFVJLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCiAgICBlbHNlaWYgZ2V0aHVpIHRoZW4KICAgICAgICBVSS5QYXJlbnQgPSBnZXRodWkoKQogICAgZWxzZQogICAgICAgIFVJLlBhcmVudCA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCiAgICBlbmQKICAgIAogICAgVUkuTmFtZSA9ICJBbmltZVJhbmdlcnNMb2dvIgogICAgVUkuWkluZGV4QmVoYXZpb3IgPSBFbnVtLlpJbmRleEJlaGF2aW9yLlNpYmxpbmcKICAgIFVJLlJlc2V0T25TcGF3biA9IGZhbHNlCiAgICAKICAgIEJ1dHRvbi5OYW1lID0gIkxvZ29CdXR0b24iCiAgICBCdXR0b24uUGFyZW50ID0gVUkKICAgIEJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoNjAsIDYwLCA2MCkKICAgIEJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4yCiAgICBCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMC45LCAtMjUsIDAuMSwgMCkKICAgIEJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDUwLCAwLCA1MCkKICAgIEJ1dHRvbi5JbWFnZSA9ICJyYnhhc3NldGlkOi8vMTA3MjM0MjQ0MDEiCiAgICBCdXR0b24uSW1hZ2VUcmFuc3BhcmVuY3kgPSAwLjEKICAgIEJ1dHRvbi5BY3RpdmUgPSB0cnVlCiAgICBCdXR0b24uRHJhZ2dhYmxlID0gdHJ1ZQogICAgCiAgICBVSUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKQogICAgVUlDb3JuZXIuUGFyZW50ID0gQnV0dG9uCiAgICAKICAgIC0tIOG6qG4gbG9nbyBiYW4gxJHhuqd1CiAgICBVSS5FbmFibGVkID0gZmFsc2UKICAgIAogICAgLS0gS2hpIGNsaWNrIHbDoG8gbG9nbwogICAgQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIFVJLkVuYWJsZWQgPSBmYWxzZQogICAgICAgIGlzTWluaW1pemVkID0gZmFsc2UKICAgICAgICAKICAgICAgICAtLSBIaeG7g24gdGjhu4sgbOG6oWkgVUkgY2jDrW5oCiAgICAgICAgaWYgV2luZG93IGFuZCBXaW5kb3cuTWluaW1pemUgdGhlbgogICAgICAgICAgICBXaW5kb3cuTWluaW1pemUoKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICByZXR1cm4gVUkKZW5kCgotLSBHaGkgxJHDqCBow6BtIG1pbmltaXplIG3hurdjIMSR4buLbmggY+G7p2EgdGjGsCB2aeG7h24KbG9jYWwgb2xkTWluaW1pemUgPSBXaW5kb3cuTWluaW1pemUKV2luZG93Lk1pbmltaXplID0gZnVuY3Rpb24oKQogICAgaXNNaW5pbWl6ZWQgPSBub3QgaXNNaW5pbWl6ZWQKICAgIAogICAgLS0gxJDhuqNtIGLhuqNvIGxvZ28gxJHDoyDEkcaw4bujYyB04bqhbwogICAgaWYgbm90IE9wZW5VSSB0aGVuCiAgICAgICAgT3BlblVJID0gQ3JlYXRlTG9nb1VJKCkKICAgIGVuZAogICAgCiAgICAtLSBIaeG7g24gdGjhu4sv4bqpbiBsb2dvIGThu7FhIHbDoG8gdHLhuqFuZyB0aMOhaQogICAgaWYgT3BlblVJIHRoZW4KICAgICAgICBPcGVuVUkuRW5hYmxlZCA9IGlzTWluaW1pemVkCiAgICAgICAgCiAgICAgICAgLS0gxJDhuqNtIGLhuqNvIGxvZ28gduG6q24gaGnhu4NuIHRo4buLIChwaMOybmcgdHLGsOG7nW5nIGjhu6NwIGLhu4sg4bqpbiBkbyBs4buXaSkKICAgICAgICBpZiBpc01pbmltaXplZCB0aGVuCiAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdhaXQoMC41KSAtLSDEkOG7o2kgbeG7mXQgY2jDunQgxJHhu4MgxJHhuqNtIGLhuqNvIFVJIMSRw6MgxJHGsOG7o2MgY+G6rXAgbmjhuq10CiAgICAgICAgICAgICAgICBpZiBPcGVuVUkgYW5kIGlzTWluaW1pemVkIHRoZW4KICAgICAgICAgICAgICAgICAgICBPcGVuVUkuRW5hYmxlZCA9IHRydWUKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgLS0gR+G7jWkgaMOgbSBtaW5pbWl6ZSBn4buRYwogICAgb2xkTWluaW1pemUoKQplbmQKCi0tIELhuq90IHPhu7Ega2nhu4duIHBow61tIMSR4buDIGvDrWNoIGhv4bqhdCBtaW5pbWl6ZQpnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpCiAgICBpZiBub3QgZ2FtZVByb2Nlc3NlZCBhbmQgaW5wdXQuS2V5Q29kZSA9PSBFbnVtLktleUNvZGUuTGVmdENvbnRyb2wgdGhlbgogICAgICAgIFdpbmRvdy5NaW5pbWl6ZSgpCiAgICBlbmQKZW5kKQoKLS0gVGjDqm0gc2VjdGlvbiB0aMO0bmcgdGluIHRyb25nIHRhYiBJbmZvCmxvY2FsIEluZm9TZWN0aW9uID0gSW5mb1RhYjpBZGRTZWN0aW9uKCJUaMO0bmcgdGluIikKCkluZm9TZWN0aW9uOkFkZFBhcmFncmFwaCh7CiAgICBUaXRsZSA9ICJBbmltZSBSYW5nZXJzIFgiLAogICAgQ29udGVudCA9ICJQaGnDqm4gYuG6o246IDEuMC4wXG5UcuG6oW5nIHRow6FpOiBIb+G6oXQgxJHhu5luZyIKfSkKCkluZm9TZWN0aW9uOkFkZFBhcmFncmFwaCh7CiAgICBUaXRsZSA9ICJOZ8aw4budaSBwaMOhdCB0cmnhu4NuIiwKICAgIENvbnRlbnQgPSAiU2NyaXB0IMSRxrDhu6NjIHBow6F0IHRyaeG7g24gYuG7n2kgRMawxqFuZyBUdeG6pW4gdsOgIGdoaml1a2xpb3AiCn0pCgotLSBLaeG7g20gdHJhIHhlbSBuZ8aw4budaSBjaMahaSDEkcOjIOG7nyB0cm9uZyBtYXAgY2jGsGEKbG9jYWwgZnVuY3Rpb24gaXNQbGF5ZXJJbk1hcCgpCiAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgaWYgbm90IHBsYXllciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgIAogICAgLS0gS2nhu4NtIHRyYSBVbml0c0ZvbGRlcgogICAgbG9jYWwgdW5pdHNGb2xkZXIgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIlVuaXRzRm9sZGVyIikKICAgIGlmIHVuaXRzRm9sZGVyIHRoZW4KICAgICAgICByZXR1cm4gdHJ1ZQogICAgZW5kCiAgICAKICAgIHJldHVybiBmYWxzZQplbmQKCi0tIFRow6ptIHNlY3Rpb24gU3RvcnkgdHJvbmcgdGFiIFBsYXkKbG9jYWwgU3RvcnlTZWN0aW9uID0gUGxheVRhYjpBZGRTZWN0aW9uKCJTdG9yeSIpCgotLSBIw6BtIMSR4buDIHRoYXkgxJHhu5VpIG1hcApsb2NhbCBmdW5jdGlvbiBjaGFuZ2VXb3JsZCh3b3JsZERpc3BsYXkpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgRXZlbnQgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJQbGF5Um9vbSIsICJFdmVudCJ9LCAyKQogICAgICAgIAogICAgICAgIGlmIEV2ZW50IHRoZW4KICAgICAgICAgICAgLS0gQ2h1eeG7g24gxJHhu5VpIHThu6sgdMOqbiBoaeG7g24gdGjhu4sgc2FuZyB0w6puIHRo4bqtdAogICAgICAgICAgICBsb2NhbCB3b3JsZFJlYWwgPSBtYXBOYW1lTWFwcGluZ1t3b3JsZERpc3BsYXldIG9yICJPbmVQaWVjZSIKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSAiQ2hhbmdlLVdvcmxkIiwKICAgICAgICAgICAgICAgIFsyXSA9IHsKICAgICAgICAgICAgICAgICAgICBbIldvcmxkIl0gPSB3b3JsZFJlYWwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIHByaW50KCLEkMOjIMSR4buVaSBtYXA6ICIgLi4gd29ybGREaXNwbGF5IC4uICIgKHRo4buxYyB04bq/OiAiIC4uIHdvcmxkUmVhbCAuLiAiKSIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgRXZlbnQgxJHhu4MgxJHhu5VpIG1hcCIpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgxJHhu5VpIG1hcDogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgZW5kCmVuZAoKLS0gSMOgbSDEkeG7gyB0aGF5IMSR4buVaSBjaGFwdGVyCmxvY2FsIGZ1bmN0aW9uIGNoYW5nZUNoYXB0ZXIobWFwLCBjaGFwdGVyKQogICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIEV2ZW50ID0gc2FmZUdldFBhdGgoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLCB7IlJlbW90ZSIsICJTZXJ2ZXIiLCAiUGxheVJvb20iLCAiRXZlbnQifSwgMikKICAgICAgICAKICAgICAgICBpZiBFdmVudCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSAiQ2hhbmdlLUNoYXB0ZXIiLAogICAgICAgICAgICAgICAgWzJdID0gewogICAgICAgICAgICAgICAgICAgIFsiQ2hhcHRlciJdID0gbWFwIC4uICJfIiAuLiBjaGFwdGVyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBwcmludCgixJDDoyDEkeG7lWkgY2hhcHRlcjogIiAuLiBtYXAgLi4gIl8iIC4uIGNoYXB0ZXIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgRXZlbnQgxJHhu4MgxJHhu5VpIGNoYXB0ZXIiKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgd2FybigiTOG7l2kga2hpIMSR4buVaSBjaGFwdGVyOiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBIw6BtIMSR4buDIHRoYXkgxJHhu5VpIGRpZmZpY3VsdHkKbG9jYWwgZnVuY3Rpb24gY2hhbmdlRGlmZmljdWx0eShkaWZmaWN1bHR5KQogICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIEV2ZW50ID0gc2FmZUdldFBhdGgoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLCB7IlJlbW90ZSIsICJTZXJ2ZXIiLCAiUGxheVJvb20iLCAiRXZlbnQifSwgMikKICAgICAgICAKICAgICAgICBpZiBFdmVudCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSAiQ2hhbmdlLURpZmZpY3VsdHkiLAogICAgICAgICAgICAgICAgWzJdID0gewogICAgICAgICAgICAgICAgICAgIFsiRGlmZmljdWx0eSJdID0gZGlmZmljdWx0eQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBFdmVudDpGaXJlU2VydmVyKHVucGFjayhhcmdzKSkKICAgICAgICAgICAgcHJpbnQoIsSQw6MgxJHhu5VpIGRpZmZpY3VsdHk6ICIgLi4gZGlmZmljdWx0eSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oIktow7RuZyB0w6xtIHRo4bqleSBFdmVudCDEkeG7gyDEkeG7lWkgZGlmZmljdWx0eSIpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgxJHhu5VpIGRpZmZpY3VsdHk6ICIgLi4gdG9zdHJpbmcoZXJyKSkKICAgIGVuZAplbmQKCi0tIEjDoG0gxJHhu4MgdG9nZ2xlIEZyaWVuZCBPbmx5CmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZUZyaWVuZE9ubHkoKQogICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIEV2ZW50ID0gc2FmZUdldFBhdGgoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLCB7IlJlbW90ZSIsICJTZXJ2ZXIiLCAiUGxheVJvb20iLCAiRXZlbnQifSwgMikKICAgICAgICAKICAgICAgICBpZiBFdmVudCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSAiQ2hhbmdlLUZyaWVuZE9ubHkiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBwcmludCgixJDDoyB0b2dnbGUgRnJpZW5kIE9ubHkiKQogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IEV2ZW50IMSR4buDIHRvZ2dsZSBGcmllbmQgT25seSIpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgdG9nZ2xlIEZyaWVuZCBPbmx5OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBIw6BtIMSR4buDIHThu7EgxJHhu5luZyB0aGFtIGdpYSBtYXAKbG9jYWwgZnVuY3Rpb24gam9pbk1hcCgpCiAgICAtLSBLaeG7g20gdHJhIHhlbSBuZ8aw4budaSBjaMahaSDEkcOjIOG7nyB0cm9uZyBtYXAgY2jGsGEKICAgIGlmIGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgcHJpbnQoIsSQw6MgcGjDoXQgaGnhu4duIG5nxrDhu51pIGNoxqFpIMSRYW5nIOG7nyB0cm9uZyBtYXAsIGtow7RuZyB0aOG7sWMgaGnhu4duIGpvaW4gbWFwIikKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAogICAgCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgLS0gTOG6pXkgRXZlbnQKICAgICAgICBsb2NhbCBFdmVudCA9IHNhZmVHZXRQYXRoKGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSwgeyJSZW1vdGUiLCAiU2VydmVyIiwgIlBsYXlSb29tIiwgIkV2ZW50In0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgbm90IEV2ZW50IHRoZW4KICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IEV2ZW50IMSR4buDIGpvaW4gbWFwIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gMS4gQ3JlYXRlCiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcigiQ3JlYXRlIikKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSAyLiBGcmllbmQgT25seSAobuG6v3UgxJHGsOG7o2MgYuG6rXQpCiAgICAgICAgaWYgZnJpZW5kT25seSB0aGVuCiAgICAgICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIoIkNoYW5nZS1GcmllbmRPbmx5IikKICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gMy4gQ2jhu41uIE1hcCB2w6AgQ2hhcHRlcgogICAgICAgIC0tIDMuMSDEkOG7lWkgTWFwCiAgICAgICAgbG9jYWwgYXJnczEgPSB7CiAgICAgICAgICAgIFsxXSA9ICJDaGFuZ2UtV29ybGQiLAogICAgICAgICAgICBbMl0gPSB7CiAgICAgICAgICAgICAgICBbIldvcmxkIl0gPSBzZWxlY3RlZE1hcAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MxKSkKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSAzLjIgxJDhu5VpIENoYXB0ZXIKICAgICAgICBsb2NhbCBhcmdzMiA9IHsKICAgICAgICAgICAgWzFdID0gIkNoYW5nZS1DaGFwdGVyIiwKICAgICAgICAgICAgWzJdID0gewogICAgICAgICAgICAgICAgWyJDaGFwdGVyIl0gPSBzZWxlY3RlZE1hcCAuLiAiXyIgLi4gc2VsZWN0ZWRDaGFwdGVyCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJnczIpKQogICAgICAgIHdhaXQoMC41KQogICAgICAgIAogICAgICAgIC0tIDMuMyDEkOG7lWkgRGlmZmljdWx0eQogICAgICAgIGxvY2FsIGFyZ3MzID0gewogICAgICAgICAgICBbMV0gPSAiQ2hhbmdlLURpZmZpY3VsdHkiLAogICAgICAgICAgICBbMl0gPSB7CiAgICAgICAgICAgICAgICBbIkRpZmZpY3VsdHkiXSA9IHNlbGVjdGVkRGlmZmljdWx0eQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MzKSkKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSA0LiBTdWJtaXQKICAgICAgICBFdmVudDpGaXJlU2VydmVyKCJTdWJtaXQiKQogICAgICAgIHdhaXQoMSkKICAgICAgICAKICAgICAgICAtLSA1LiBTdGFydAogICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIoIlN0YXJ0IikKICAgICAgICAKICAgICAgICBwcmludCgixJDDoyBqb2luIG1hcDogIiAuLiBzZWxlY3RlZE1hcCAuLiAiXyIgLi4gc2VsZWN0ZWRDaGFwdGVyIC4uICIgduG7m2kgxJHhu5kga2jDsyAiIC4uIHNlbGVjdGVkRGlmZmljdWx0eSkKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSBqb2luIG1hcDogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICAKICAgIHJldHVybiB0cnVlCmVuZAoKLS0gRHJvcGRvd24gxJHhu4MgY2jhu41uIE1hcApTdG9yeVNlY3Rpb246QWRkRHJvcGRvd24oIk1hcERyb3Bkb3duIiwgewogICAgVGl0bGUgPSAiQ2hvb3NlIE1hcCIsCiAgICBWYWx1ZXMgPSB7IlZvb2NoYSBWaWxsYWdlIiwgIkdyZWVuIFBsYW5ldCIsICJEZW1vbiBGb3Jlc3QiLCAiTGVhZiBWaWxsYWdlIiwgIlogQ2l0eSJ9LAogICAgTXVsdGkgPSBmYWxzZSwKICAgIERlZmF1bHQgPSBzZWxlY3RlZERpc3BsYXlNYXAsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIHNlbGVjdGVkRGlzcGxheU1hcCA9IFZhbHVlCiAgICAgICAgc2VsZWN0ZWRNYXAgPSBtYXBOYW1lTWFwcGluZ1tWYWx1ZV0gb3IgIk9uZVBpZWNlIgogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlNlbGVjdGVkTWFwID0gc2VsZWN0ZWRNYXAKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgCiAgICAgICAgLS0gVGhheSDEkeG7lWkgbWFwIGtoaSBuZ8aw4budaSBkw7luZyBjaOG7jW4KICAgICAgICBjaGFuZ2VXb3JsZChWYWx1ZSkKICAgICAgICBwcmludCgixJDDoyBjaOG7jW4gbWFwOiAiIC4uIFZhbHVlIC4uICIgKHRo4buxYyB04bq/OiAiIC4uIHNlbGVjdGVkTWFwIC4uICIpIikKICAgIGVuZAp9KQoKLS0gRHJvcGRvd24gxJHhu4MgY2jhu41uIENoYXB0ZXIKU3RvcnlTZWN0aW9uOkFkZERyb3Bkb3duKCJDaGFwdGVyRHJvcGRvd24iLCB7CiAgICBUaXRsZSA9ICJDaG9vc2UgQ2hhcHRlciIsCiAgICBWYWx1ZXMgPSB7IkNoYXB0ZXIxIiwgIkNoYXB0ZXIyIiwgIkNoYXB0ZXIzIiwgIkNoYXB0ZXI0IiwgIkNoYXB0ZXI1IiwgIkNoYXB0ZXI2IiwgIkNoYXB0ZXI3IiwgIkNoYXB0ZXI4IiwgIkNoYXB0ZXI5IiwgIkNoYXB0ZXIxMCJ9LAogICAgTXVsdGkgPSBmYWxzZSwKICAgIERlZmF1bHQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TZWxlY3RlZENoYXB0ZXIgb3IgIkNoYXB0ZXIxIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgc2VsZWN0ZWRDaGFwdGVyID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TZWxlY3RlZENoYXB0ZXIgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICAtLSBUaGF5IMSR4buVaSBjaGFwdGVyIGtoaSBuZ8aw4budaSBkw7luZyBjaOG7jW4KICAgICAgICBjaGFuZ2VDaGFwdGVyKHNlbGVjdGVkTWFwLCBWYWx1ZSkKICAgICAgICBwcmludCgixJDDoyBjaOG7jW4gY2hhcHRlcjogIiAuLiBWYWx1ZSkKICAgIGVuZAp9KQoKLS0gRHJvcGRvd24gxJHhu4MgY2jhu41uIERpZmZpY3VsdHkKU3RvcnlTZWN0aW9uOkFkZERyb3Bkb3duKCJEaWZmaWN1bHR5RHJvcGRvd24iLCB7CiAgICBUaXRsZSA9ICJDaG9vc2UgRGlmZmljdWx0eSIsCiAgICBWYWx1ZXMgPSB7Ik5vcm1hbCIsICJIYXJkIiwgIk5pZ2h0bWFyZSJ9LAogICAgTXVsdGkgPSBmYWxzZSwKICAgIERlZmF1bHQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TZWxlY3RlZERpZmZpY3VsdHkgb3IgIk5vcm1hbCIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIHNlbGVjdGVkRGlmZmljdWx0eSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2VsZWN0ZWREaWZmaWN1bHR5ID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgCiAgICAgICAgLS0gVGhheSDEkeG7lWkgZGlmZmljdWx0eSBraGkgbmfGsOG7nWkgZMO5bmcgY2jhu41uCiAgICAgICAgY2hhbmdlRGlmZmljdWx0eShWYWx1ZSkKICAgICAgICBwcmludCgixJDDoyBjaOG7jW4gZGlmZmljdWx0eTogIiAuLiBWYWx1ZSkKICAgICAgICAKICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiRGlmZmljdWx0eSBDaGFuZ2VkIiwKICAgICAgICAgICAgQ29udGVudCA9ICLEkMOjIMSR4buVaSDEkeG7mSBraMOzIHRow6BuaDogIiAuLiBWYWx1ZSwKICAgICAgICAgICAgRHVyYXRpb24gPSAyCiAgICAgICAgfSkKICAgIGVuZAp9KQoKLS0gVG9nZ2xlIEZyaWVuZCBPbmx5ClN0b3J5U2VjdGlvbjpBZGRUb2dnbGUoIkZyaWVuZE9ubHlUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJGcmllbmQgT25seSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuRnJpZW5kT25seSBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgZnJpZW5kT25seSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuRnJpZW5kT25seSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIAogICAgICAgIC0tIFRvZ2dsZSBGcmllbmQgT25seSBraGkgbmfGsOG7nWkgZMO5bmcgdGhheSDEkeG7lWkKICAgICAgICB0b2dnbGVGcmllbmRPbmx5KCkKICAgICAgICAKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiRnJpZW5kIE9ubHkiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICLEkMOjIGLhuq10IGNo4bq/IMSR4buZIEZyaWVuZCBPbmx5IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJGcmllbmQgT25seSIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIsSQw6MgdOG6r3QgY2jhur8gxJHhu5kgRnJpZW5kIE9ubHkiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAyCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBBdXRvIEpvaW4gTWFwClN0b3J5U2VjdGlvbjpBZGRUb2dnbGUoIkF1dG9Kb2luTWFwVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBKb2luIE1hcCIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5NYXAgb3IgZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGF1dG9Kb2luTWFwRW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5NYXAgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBhdXRvSm9pbk1hcEVuYWJsZWQgdGhlbgogICAgICAgICAgICAtLSBLaeG7g20gdHJhIG5nYXkgbOG6rXAgdOG7qWMgbuG6v3UgbmfGsOG7nWkgY2jGoWkgxJFhbmcg4bufIHRyb25nIG1hcAogICAgICAgICAgICBpZiBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIE1hcCIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICLEkGFuZyDhu58gdHJvbmcgbWFwLCBBdXRvIEpvaW4gTWFwIHPhur0gaG/huqF0IMSR4buZbmcga2hpIGLhuqFuIHLhu51pIGto4buPaSBtYXAiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIE1hcCIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIEpvaW4gTWFwIMSRw6MgxJHGsOG7o2MgYuG6rXQsIHPhur0gYuG6r3QgxJHhuqd1IHNhdSAiIC4uIHN0b3J5VGltZURlbGF5IC4uICIgZ2nDonkiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLS0gVGjhu7FjIGhp4buHbiBqb2luIG1hcCBzYXUgdGjhu51pIGdpYW4gZGVsYXkKICAgICAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICB3YWl0KHN0b3J5VGltZURlbGF5KQogICAgICAgICAgICAgICAgICAgIGlmIGF1dG9Kb2luTWFwRW5hYmxlZCBhbmQgbm90IGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5NYXAoKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFThuqFvIHbDsm5nIGzhurdwIEF1dG8gSm9pbiBNYXAKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b0pvaW5NYXBFbmFibGVkIGFuZCB3YWl0KDEwKSBkbyAtLSBUaOG7rSBqb2luIG1hcCBt4buXaSAxMCBnacOieQogICAgICAgICAgICAgICAgICAgIC0tIENo4buJIHRo4buxYyBoaeG7h24gam9pbiBtYXAgbuG6v3UgbmfGsOG7nWkgY2jGoWkga2jDtG5nIOG7nyB0cm9uZyBtYXAKICAgICAgICAgICAgICAgICAgICBpZiBub3QgaXNQbGF5ZXJJbk1hcCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgLS0gw4FwIGThu6VuZyB0aW1lIGRlbGF5CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLEkOG7o2kgIiAuLiBzdG9yeVRpbWVEZWxheSAuLiAiIGdpw6J5IHRyxrDhu5tjIGtoaSBqb2luIG1hcCIpCiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXQoc3RvcnlUaW1lRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAtLSBLaeG7g20gdHJhIGzhuqFpIHNhdSBraGkgZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXV0b0pvaW5NYXBFbmFibGVkIGFuZCBub3QgaXNQbGF5ZXJJbk1hcCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5NYXAoKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIE5nxrDhu51pIGNoxqFpIMSRYW5nIOG7nyB0cm9uZyBtYXAsIGtow7RuZyBj4bqnbiBqb2luCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLEkGFuZyDhu58gdHJvbmcgbWFwLCDEkeG7o2kgxJHhur9uIGtoaSBuZ8aw4budaSBjaMahaSBy4budaSBraOG7j2kgbWFwIikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gSm9pbiBNYXAiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIEpvaW4gTWFwIMSRw6MgxJHGsOG7o2MgdOG6r3QiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCgotLSBIaeG7g24gdGjhu4sgdHLhuqFuZyB0aMOhaSB0cm9uZyBnYW1lClN0b3J5U2VjdGlvbjpBZGRQYXJhZ3JhcGgoewogICAgVGl0bGUgPSAiVHLhuqFuZyB0aMOhaSIsCiAgICBDb250ZW50ID0gIk5o4bqlbiBuw7p0IGLDqm4gZMaw4bubaSDEkeG7gyBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSIKfSkKCi0tIFRow6ptIG7DunQgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkKU3RvcnlTZWN0aW9uOkFkZEJ1dHRvbih7CiAgICBUaXRsZSA9ICJD4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBzdGF0dXNUZXh0ID0gaXNQbGF5ZXJJbk1hcCgpIGFuZCAixJBhbmcg4bufIHRyb25nIG1hcCIgb3IgIsSQYW5nIOG7nyBz4bqjbmggY2jhu50iCiAgICAgICAgCiAgICAgICAgLS0gSGnhu4NuIHRo4buLIHRow7RuZyBiw6FvIHbhu5tpIHRy4bqhbmcgdGjDoWkgaGnhu4duIHThuqFpCiAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlRy4bqhbmcgdGjDoWkgaGnhu4duIHThuqFpIiwKICAgICAgICAgICAgQ29udGVudCA9IHN0YXR1c1RleHQsCiAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgcHJpbnQoIlRy4bqhbmcgdGjDoWk6ICIgLi4gc3RhdHVzVGV4dCkKICAgIGVuZAp9KQoKLS0gVGjDqm0gc2VjdGlvbiBTdW1tb24gdHJvbmcgdGFiIFNob3AKbG9jYWwgU3VtbW9uU2VjdGlvbiA9IFNob3BUYWI6QWRkU2VjdGlvbigiU3VtbW9uIikKCi0tIEjDoG0gdGjhu7FjIGhp4buHbiBzdW1tb24KbG9jYWwgZnVuY3Rpb24gcGVyZm9ybVN1bW1vbigpCiAgICAtLSBBbiB0b8OgbiBraeG7g20gdHJhIFJlbW90ZSBjw7MgdOG7k24gdOG6oWkga2jDtG5nCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgUmVtb3RlID0gc2FmZUdldFBhdGgoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLCB7IlJlbW90ZSIsICJTZXJ2ZXIiLCAiR2FtYmxpbmciLCAiVW5pdHNHYWNoYSJ9LCAyKQogICAgICAgIAogICAgICAgIGlmIFJlbW90ZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSBzZWxlY3RlZFN1bW1vbkFtb3VudCwKICAgICAgICAgICAgICAgIFsyXSA9IHNlbGVjdGVkU3VtbW9uQmFubmVyLAogICAgICAgICAgICAgICAgWzNdID0ge30KICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgUmVtb3RlOkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBwcmludCgixJDDoyBzdW1tb246ICIgLi4gc2VsZWN0ZWRTdW1tb25BbW91bnQgLi4gIiAtICIgLi4gc2VsZWN0ZWRTdW1tb25CYW5uZXIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUmVtb3RlIFVuaXRzR2FjaGEiKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgd2FybigiTOG7l2kga2hpIHN1bW1vbjogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgZW5kCmVuZAoKLS0gRHJvcGRvd24gxJHhu4MgY2jhu41uIHPhu5EgbMaw4bujbmcgc3VtbW9uClN1bW1vblNlY3Rpb246QWRkRHJvcGRvd24oIlN1bW1vbkFtb3VudERyb3Bkb3duIiwgewogICAgVGl0bGUgPSAiQ2hvb3NlIFN1bW1vbiBBbW91bnQiLAogICAgVmFsdWVzID0geyJ4MSIsICJ4MTAifSwKICAgIE11bHRpID0gZmFsc2UsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU3VtbW9uQW1vdW50IG9yICJ4MSIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIHNlbGVjdGVkU3VtbW9uQW1vdW50ID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TdW1tb25BbW91bnQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICBwcmludCgixJDDoyBjaOG7jW4gc3VtbW9uIGFtb3VudDogIiAuLiBWYWx1ZSkKICAgIGVuZAp9KQoKLS0gRHJvcGRvd24gxJHhu4MgY2jhu41uIGJhbm5lcgpTdW1tb25TZWN0aW9uOkFkZERyb3Bkb3duKCJTdW1tb25CYW5uZXJEcm9wZG93biIsIHsKICAgIFRpdGxlID0gIkNob29zZSBCYW5uZXIiLAogICAgVmFsdWVzID0geyJTdGFuZGFyZCIsICJSYXRlLVVwIn0sCiAgICBNdWx0aSA9IGZhbHNlLAogICAgRGVmYXVsdCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlN1bW1vbkJhbm5lciBvciAiU3RhbmRhcmQiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBzZWxlY3RlZFN1bW1vbkJhbm5lciA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU3VtbW9uQmFubmVyID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgcHJpbnQoIsSQw6MgY2jhu41uIGJhbm5lcjogIiAuLiBWYWx1ZSkKICAgIGVuZAp9KQoKLS0gTsO6dCBtYW51YWwgc3VtbW9uClN1bW1vblNlY3Rpb246QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIlN1bW1vbiBPbmNlIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oKQogICAgICAgIHBlcmZvcm1TdW1tb24oKQogICAgICAgIAogICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJTdW1tb24iLAogICAgICAgICAgICBDb250ZW50ID0gIsSQw6Mgc3VtbW9uOiAiIC4uIHNlbGVjdGVkU3VtbW9uQW1vdW50IC4uICIgLSAiIC4uIHNlbGVjdGVkU3VtbW9uQmFubmVyLAogICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICB9KQogICAgZW5kCn0pCgotLSBUb2dnbGUgQXV0byBTdW1tb24KU3VtbW9uU2VjdGlvbjpBZGRUb2dnbGUoIkF1dG9TdW1tb25Ub2dnbGUiLCB7CiAgICBUaXRsZSA9ICJBdXRvIFN1bW1vbiIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1N1bW1vbiBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgYXV0b1N1bW1vbkVuYWJsZWQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9TdW1tb24gPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBhdXRvU3VtbW9uRW5hYmxlZCB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBTdW1tb24iLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFN1bW1vbiDEkcOjIMSRxrDhu6NjIGLhuq10IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVOG6oW8gdsOybmcgbOG6t3AgQXV0byBTdW1tb24KICAgICAgICAgICAgaWYgYXV0b1N1bW1vbkxvb3AgdGhlbgogICAgICAgICAgICAgICAgYXV0b1N1bW1vbkxvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBhdXRvU3VtbW9uTG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFPhu60gZOG7pW5nIHNwYXduIHRoYXkgdsOsIGNvcm91dGluZQogICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvU3VtbW9uRW5hYmxlZCBhbmQgd2FpdCgyKSBkbyAtLSBTdW1tb24gbeG7l2kgMiBnacOieQogICAgICAgICAgICAgICAgICAgIHBlcmZvcm1TdW1tb24oKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgCiAgICAgICAgZWxzZQogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gU3VtbW9uIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBTdW1tb24gxJHDoyDEkcaw4bujYyB04bqvdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGF1dG9TdW1tb25Mb29wIHRoZW4KICAgICAgICAgICAgICAgIGF1dG9TdW1tb25Mb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b1N1bW1vbkxvb3AgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRow6ptIHNlY3Rpb24gUXVlc3QgdHJvbmcgdGFiIFNob3AKbG9jYWwgUXVlc3RTZWN0aW9uID0gU2hvcFRhYjpBZGRTZWN0aW9uKCJRdWVzdCIpCgotLSBIw6BtIMSR4buDIG5o4bqtbiB04bqldCBj4bqjIG5oaeG7h20gduG7pQpsb2NhbCBmdW5jdGlvbiBjbGFpbUFsbFF1ZXN0cygpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgLS0gS2nhu4NtIHRyYSBhbiB0b8OgbiDEkcaw4budbmcgZOG6q24gUGxheWVyRGF0YQogICAgICAgIGxvY2FsIFJlcGxpY2F0ZWRTdG9yYWdlID0gc2FmZUdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIikKICAgICAgICBpZiBub3QgUmVwbGljYXRlZFN0b3JhZ2UgdGhlbgogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUmVwbGljYXRlZFN0b3JhZ2UiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCBQbGF5ZXJEYXRhID0gc2FmZUdldENoaWxkKFJlcGxpY2F0ZWRTdG9yYWdlLCAiUGxheWVyX0RhdGEiLCAyKQogICAgICAgIGlmIG5vdCBQbGF5ZXJEYXRhIHRoZW4KICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IFBsYXllcl9EYXRhIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgUGxheWVyRm9sZGVyID0gc2FmZUdldENoaWxkKFBsYXllckRhdGEsIHBsYXllck5hbWUsIDIpCiAgICAgICAgaWYgbm90IFBsYXllckZvbGRlciB0aGVuCiAgICAgICAgICAgIHdhcm4oIktow7RuZyB0w6xtIHRo4bqleSBk4buvIGxp4buHdSBuZ8aw4budaSBjaMahaTogIiAuLiBwbGF5ZXJOYW1lKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCBEYWlseVF1ZXN0ID0gc2FmZUdldENoaWxkKFBsYXllckZvbGRlciwgIkRhaWx5UXVlc3QiLCAyKQogICAgICAgIGlmIG5vdCBEYWlseVF1ZXN0IHRoZW4KICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IERhaWx5UXVlc3QiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBM4bqleSDEkcaw4budbmcgZOG6q24gxJHhur9uIFF1ZXN0RXZlbnQKICAgICAgICBsb2NhbCBRdWVzdEV2ZW50ID0gc2FmZUdldFBhdGgoUmVwbGljYXRlZFN0b3JhZ2UsIHsiUmVtb3RlIiwgIlNlcnZlciIsICJHYW1lcGxheSIsICJRdWVzdEV2ZW50In0sIDIpCiAgICAgICAgaWYgbm90IFF1ZXN0RXZlbnQgdGhlbgogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUXVlc3RFdmVudCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIFTDrG0gdOG6pXQgY+G6oyBuaGnhu4dtIHbhu6UgY8OzIHRo4buDIG5o4bqtbgogICAgICAgIGZvciBfLCBxdWVzdCBpbiBwYWlycyhEYWlseVF1ZXN0OkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHF1ZXN0IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICAgICAgWzFdID0gIkNsYWltQWxsIiwKICAgICAgICAgICAgICAgICAgICBbMl0gPSBxdWVzdAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBRdWVzdEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICAgICAgd2FpdCgwLjIpIC0tIENo4budIG3hu5l0IGNow7p0IGdp4buvYSBjw6FjIGzhuqduIGNsYWltIMSR4buDIHRyw6FuaCBsYWcKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgY2xhaW0gcXVlc3Q6ICIgLi4gdG9zdHJpbmcoZXJyKSkKICAgIGVuZAplbmQKCi0tIE7DunQgQ2xhaW0gQWxsIFF1ZXN0IChtYW51YWwpClF1ZXN0U2VjdGlvbjpBZGRCdXR0b24oewogICAgVGl0bGUgPSAiQ2xhaW0gQWxsIFF1ZXN0cyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBjbGFpbUFsbFF1ZXN0cygpCiAgICAgICAgCiAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIlF1ZXN0cyIsCiAgICAgICAgICAgIENvbnRlbnQgPSAixJDDoyBjbGFpbSB04bqldCBj4bqjIG5oaeG7h20gduG7pSIsCiAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBBdXRvIENsYWltIEFsbCBRdWVzdApRdWVzdFNlY3Rpb246QWRkVG9nZ2xlKCJBdXRvQ2xhaW1RdWVzdFRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkF1dG8gQ2xhaW0gQWxsIFF1ZXN0cyIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0NsYWltUXVlc3Qgb3IgZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGF1dG9DbGFpbVF1ZXN0RW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0NsYWltUXVlc3QgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBhdXRvQ2xhaW1RdWVzdEVuYWJsZWQgdGhlbgogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gQ2xhaW0gUXVlc3RzIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBDbGFpbSBRdWVzdHMgxJHDoyDEkcaw4bujYyBi4bqtdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFThuqFvIHbDsm5nIGzhurdwIEF1dG8gQ2xhaW0gUXVlc3RzCiAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9DbGFpbVF1ZXN0RW5hYmxlZCBhbmQgd2FpdCgzMCkgZG8gLS0gQ2xhaW0gbeG7l2kgMzAgZ2nDonkKICAgICAgICAgICAgICAgICAgICBjbGFpbUFsbFF1ZXN0cygpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIENsYWltIFF1ZXN0cyIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gQ2xhaW0gUXVlc3RzIMSRw6MgxJHGsOG7o2MgdOG6r3QiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRow6ptIHNlY3Rpb24gdGhp4bq/dCBs4bqtcCB0cm9uZyB0YWIgU2V0dGluZ3MKbG9jYWwgU2V0dGluZ3NTZWN0aW9uID0gU2V0dGluZ3NUYWI6QWRkU2VjdGlvbigiVGhp4bq/dCBs4bqtcCIpCgotLSBEcm9wZG93biBjaOG7jW4gdGhlbWUKU2V0dGluZ3NTZWN0aW9uOkFkZERyb3Bkb3duKCJUaGVtZURyb3Bkb3duIiwgewogICAgVGl0bGUgPSAiQ2jhu41uIFRoZW1lIiwKICAgIFZhbHVlcyA9IHsiRGFyayIsICJMaWdodCIsICJEYXJrZXIiLCAiQXF1YSIsICJBbWV0aHlzdCJ9LAogICAgTXVsdGkgPSBmYWxzZSwKICAgIERlZmF1bHQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5VSVRoZW1lIG9yICJEYXJrIiwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuVUlUaGVtZSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIHByaW50KCLEkMOjIGNo4buNbiB0aGVtZTogIiAuLiBWYWx1ZSkKICAgIGVuZAp9KQoKLS0gQXV0byBTYXZlIENvbmZpZwpsb2NhbCBmdW5jdGlvbiBBdXRvU2F2ZUNvbmZpZygpCiAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgd2FpdCg1KSBkbyAtLSBMxrB1IG3hu5dpIDUgZ2nDonkKICAgICAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgICAgICBlbmQpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKLS0gVGjDqm0gZXZlbnQgbGlzdGVuZXIgxJHhu4MgbMawdSBuZ2F5IGtoaSB0aGF5IMSR4buVaSBnacOhIHRy4buLCmxvY2FsIGZ1bmN0aW9uIHNldHVwU2F2ZUV2ZW50cygpCiAgICBmb3IgXywgdGFiIGluIHBhaXJzKHtJbmZvVGFiLCBQbGF5VGFiLCBTaG9wVGFiLCBTZXR0aW5nc1RhYn0pIGRvCiAgICAgICAgaWYgdGFiIGFuZCB0YWIuX2NvbXBvbmVudHMgdGhlbgogICAgICAgICAgICBmb3IgXywgZWxlbWVudCBpbiBwYWlycyh0YWIuX2NvbXBvbmVudHMpIGRvCiAgICAgICAgICAgICAgICBpZiBlbGVtZW50IGFuZCBlbGVtZW50Lk9uQ2hhbmdlZCB0aGVuCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5PbkNoYW5nZWQ6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAgICAgICAgICAgICAgICAgZW5kKQogICAgICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAplbmQKCi0tIFTDrWNoIGjhu6NwIHbhu5tpIFNhdmVNYW5hZ2VyClNhdmVNYW5hZ2VyOlNldExpYnJhcnkoRmx1ZW50KQpJbnRlcmZhY2VNYW5hZ2VyOlNldExpYnJhcnkoRmx1ZW50KQoKLS0gVGhheSDEkeG7lWkgY8OhY2ggbMawdSBj4bqldSBow6xuaCDEkeG7gyBz4butIGThu6VuZyB0w6puIG5nxrDhu51pIGNoxqFpCkludGVyZmFjZU1hbmFnZXI6U2V0Rm9sZGVyKCJIVEh1YkFSIikKU2F2ZU1hbmFnZXI6U2V0Rm9sZGVyKCJIVEh1YkFSLyIgLi4gcGxheWVyTmFtZSkKCi0tIFRow6ptIHRow7RuZyB0aW4gdsOgbyB0YWIgU2V0dGluZ3MKU2V0dGluZ3NUYWI6QWRkUGFyYWdyYXBoKHsKICAgIFRpdGxlID0gIkPhuqV1IGjDrG5oIHThu7EgxJHhu5luZyIsCiAgICBDb250ZW50ID0gIkPhuqV1IGjDrG5oIGPhu6dhIGLhuqFuIMSRYW5nIMSRxrDhu6NjIHThu7EgxJHhu5luZyBsxrB1IHRoZW8gdMOqbiBuaMOibiB24bqtdDogIiAuLiBwbGF5ZXJOYW1lCn0pCgpTZXR0aW5nc1RhYjpBZGRQYXJhZ3JhcGgoewogICAgVGl0bGUgPSAiUGjDrW0gdOG6r3QiLAogICAgQ29udGVudCA9ICJOaOG6pW4gTGVmdENvbnRyb2wgxJHhu4Mg4bqpbi9oaeG7h24gZ2lhbyBkaeG7h24iCn0pCgotLSBUaOG7sWMgdGhpIHThu7EgxJHhu5luZyBsxrB1IGPhuqV1IGjDrG5oCkF1dG9TYXZlQ29uZmlnKCkKCi0tIFRoaeG6v3QgbOG6rXAgZXZlbnRzCnNldHVwU2F2ZUV2ZW50cygpCgotLSBLaeG7g20gdHJhIHRy4bqhbmcgdGjDoWkgbmfGsOG7nWkgY2jGoWkga2hpIHNjcmlwdCBraOG7n2kgxJHhu5luZwppZiBpc1BsYXllckluTWFwKCkgdGhlbgogICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgVGl0bGUgPSAiUGjDoXQgaGnhu4duIHRy4bqhbmcgdGjDoWkiLAogICAgICAgIENvbnRlbnQgPSAiQuG6oW4gxJFhbmcg4bufIHRyb25nIG1hcCwgQXV0byBKb2luIHPhur0gY2jhu4kgaG/huqF0IMSR4buZbmcga2hpIGLhuqFuIHLhu51pIGto4buPaSBtYXAiLAogICAgICAgIER1cmF0aW9uID0gMwogICAgfSkKZWxzZQogICAgLS0gTuG6v3UgQXV0byBKb2luIE1hcCDEkcaw4bujYyBi4bqtdCwgdGjhu7FjIGhp4buHbiBqb2luIG1hcCBzYXUgdGltZSBkZWxheQogICAgaWYgYXV0b0pvaW5NYXBFbmFibGVkIHRoZW4KICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIiwKICAgICAgICAgICAgQ29udGVudCA9ICJT4bq9IHRoYW0gZ2lhIFN0b3J5IE1hcCBzYXUgIiAuLiBzdG9yeVRpbWVEZWxheSAuLiAiIGdpw6J5IiwKICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdhaXQoc3RvcnlUaW1lRGVsYXkpIC0tIENo4budIHRoZW8gdGltZSBkZWxheSDEkcOjIMSR4bq3dAogICAgICAgICAgICBpZiBhdXRvSm9pbk1hcEVuYWJsZWQgYW5kIG5vdCBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgam9pbk1hcCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAogICAgCiAgICAtLSBO4bq/dSBBdXRvIEpvaW4gUmFuZ2VyIMSRxrDhu6NjIGLhuq10LCB0aOG7sWMgaGnhu4duIGpvaW4gcmFuZ2VyIHNhdSB0aW1lIGRlbGF5CiAgICBpZiBhdXRvSm9pblJhbmdlckVuYWJsZWQgdGhlbgogICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICBUaXRsZSA9ICJBdXRvIEpvaW4iLAogICAgICAgICAgICBDb250ZW50ID0gIlPhur0gdGhhbSBnaWEgUmFuZ2VyIFN0YWdlIHNhdSAiIC4uIHJhbmdlclRpbWVEZWxheSAuLiAiIGdpw6J5IiwKICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdhaXQocmFuZ2VyVGltZURlbGF5KSAtLSBDaOG7nSB0aGVvIHRpbWUgZGVsYXkgxJHDoyDEkeG6t3QKICAgICAgICAgICAgaWYgYXV0b0pvaW5SYW5nZXJFbmFibGVkIGFuZCBub3QgaXNQbGF5ZXJJbk1hcCgpIHRoZW4KICAgICAgICAgICAgICAgIGpvaW5SYW5nZXJTdGFnZSgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAogICAgCiAgICAtLSBO4bq/dSBBdXRvIEJvc3MgRXZlbnQgxJHGsOG7o2MgYuG6rXQsIHRo4buxYyBoaeG7h24gam9pbiBib3NzIGV2ZW50IHNhdSB0aW1lIGRlbGF5CiAgICBpZiBhdXRvQm9zc0V2ZW50RW5hYmxlZCB0aGVuCiAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gSm9pbiIsCiAgICAgICAgICAgIENvbnRlbnQgPSAiU+G6vSB0aGFtIGdpYSBCb3NzIEV2ZW50IHNhdSAiIC4uIGJvc3NFdmVudFRpbWVEZWxheSAuLiAiIGdpw6J5IiwKICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgfSkKICAgICAgICAKICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgIHdhaXQoYm9zc0V2ZW50VGltZURlbGF5KSAtLSBDaOG7nSB0aGVvIHRpbWUgZGVsYXkgxJHDoyDEkeG6t3QKICAgICAgICAgICAgaWYgYXV0b0Jvc3NFdmVudEVuYWJsZWQgYW5kIG5vdCBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgam9pbkJvc3NFdmVudCgpCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZCkKICAgIGVuZAplbmQKCi0tIFRow7RuZyBiw6FvIGtoaSBzY3JpcHQgxJHDoyB04bqjaSB4b25nCkZsdWVudDpOb3RpZnkoewogICAgVGl0bGUgPSAiSFQgSHViIHwgQW5pbWUgUmFuZ2VycyBYIiwKICAgIENvbnRlbnQgPSAiU2NyaXB0IMSRw6MgdOG6o2kgdGjDoG5oIGPDtG5nISDEkMOjIHThuqNpIGPhuqV1IGjDrG5oIGNobyAiIC4uIHBsYXllck5hbWUsCiAgICBEdXJhdGlvbiA9IDMKfSkKCnByaW50KCJBbmltZSBSYW5nZXJzIFggU2NyaXB0IGhhcyBiZWVuIGxvYWRlZCEiKQoKLS0gVGjDqm0gc2VjdGlvbiBSYW5nZXIgU3RhZ2UgdHJvbmcgdGFiIFBsYXkKbG9jYWwgUmFuZ2VyU2VjdGlvbiA9IFBsYXlUYWI6QWRkU2VjdGlvbigiUmFuZ2VyIFN0YWdlIikKCi0tIEjDoG0gxJHhu4MgdGhheSDEkeG7lWkgYWN0CmxvY2FsIGZ1bmN0aW9uIGNoYW5nZUFjdChtYXAsIGFjdCkKICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBFdmVudCA9IHNhZmVHZXRQYXRoKGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSwgeyJSZW1vdGUiLCAiU2VydmVyIiwgIlBsYXlSb29tIiwgIkV2ZW50In0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgRXZlbnQgdGhlbgogICAgICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICAgICAgWzFdID0gIkNoYW5nZS1DaGFwdGVyIiwKICAgICAgICAgICAgICAgIFsyXSA9IHsKICAgICAgICAgICAgICAgICAgICBbIkNoYXB0ZXIiXSA9IG1hcCAuLiAiXyIgLi4gYWN0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKGFyZ3MpKQogICAgICAgICAgICBwcmludCgixJDDoyDEkeG7lWkgYWN0OiAiIC4uIG1hcCAuLiAiXyIgLi4gYWN0KQogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IEV2ZW50IMSR4buDIMSR4buVaSBhY3QiKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgd2FybigiTOG7l2kga2hpIMSR4buVaSBhY3Q6ICIgLi4gdG9zdHJpbmcoZXJyKSkKICAgIGVuZAplbmQKCi0tIEjDoG0gxJHhu4MgdG9nZ2xlIEZyaWVuZCBPbmx5IGNobyBSYW5nZXIKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlUmFuZ2VyRnJpZW5kT25seSgpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgRXZlbnQgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJQbGF5Um9vbSIsICJFdmVudCJ9LCAyKQogICAgICAgIAogICAgICAgIGlmIEV2ZW50IHRoZW4KICAgICAgICAgICAgbG9jYWwgYXJncyA9IHsKICAgICAgICAgICAgICAgIFsxXSA9ICJDaGFuZ2UtRnJpZW5kT25seSIKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIHByaW50KCLEkMOjIHRvZ2dsZSBGcmllbmQgT25seSBjaG8gUmFuZ2VyIikKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oIktow7RuZyB0w6xtIHRo4bqleSBFdmVudCDEkeG7gyB0b2dnbGUgRnJpZW5kIE9ubHkiKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgd2FybigiTOG7l2kga2hpIHRvZ2dsZSBGcmllbmQgT25seTogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgZW5kCmVuZAoKLS0gSMOgbSDEkeG7gyB04buxIMSR4buZbmcgdGhhbSBnaWEgUmFuZ2VyIFN0YWdlCmxvY2FsIGZ1bmN0aW9uIGpvaW5SYW5nZXJTdGFnZSgpCiAgICAtLSBLaeG7g20gdHJhIHhlbSBuZ8aw4budaSBjaMahaSDEkcOjIOG7nyB0cm9uZyBtYXAgY2jGsGEKICAgIGlmIGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgcHJpbnQoIsSQw6MgcGjDoXQgaGnhu4duIG5nxrDhu51pIGNoxqFpIMSRYW5nIOG7nyB0cm9uZyBtYXAsIGtow7RuZyB0aOG7sWMgaGnhu4duIGpvaW4gUmFuZ2VyIFN0YWdlIikKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAogICAgCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgLS0gTOG6pXkgRXZlbnQKICAgICAgICBsb2NhbCBFdmVudCA9IHNhZmVHZXRQYXRoKGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSwgeyJSZW1vdGUiLCAiU2VydmVyIiwgIlBsYXlSb29tIiwgIkV2ZW50In0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgbm90IEV2ZW50IHRoZW4KICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IEV2ZW50IMSR4buDIGpvaW4gUmFuZ2VyIFN0YWdlIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gMS4gQ3JlYXRlCiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcigiQ3JlYXRlIikKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSAyLiBDaGFuZ2UgTW9kZSB0byBSYW5nZXIgU3RhZ2UKICAgICAgICBsb2NhbCBtb2RlQXJncyA9IHsKICAgICAgICAgICAgWzFdID0gIkNoYW5nZS1Nb2RlIiwKICAgICAgICAgICAgWzJdID0gewogICAgICAgICAgICAgICAgWyJNb2RlIl0gPSAiUmFuZ2VyIFN0YWdlIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIodW5wYWNrKG1vZGVBcmdzKSkKICAgICAgICB3YWl0KDAuNSkKICAgICAgICAKICAgICAgICAtLSAzLiBGcmllbmQgT25seSAobuG6v3UgxJHGsOG7o2MgYuG6rXQpCiAgICAgICAgaWYgcmFuZ2VyRnJpZW5kT25seSB0aGVuCiAgICAgICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIoIkNoYW5nZS1GcmllbmRPbmx5IikKICAgICAgICAgICAgd2FpdCgwLjUpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gNC4gQ2jhu41uIE1hcCB2w6AgQWN0CiAgICAgICAgLS0gNC4xIMSQ4buVaSBNYXAKICAgICAgICBsb2NhbCBhcmdzMSA9IHsKICAgICAgICAgICAgWzFdID0gIkNoYW5nZS1Xb3JsZCIsCiAgICAgICAgICAgIFsyXSA9IHsKICAgICAgICAgICAgICAgIFsiV29ybGQiXSA9IHNlbGVjdGVkUmFuZ2VyTWFwCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJnczEpKQogICAgICAgIHdhaXQoMC41KQogICAgICAgIAogICAgICAgIC0tIDQuMiDEkOG7lWkgQWN0CiAgICAgICAgbG9jYWwgYXJnczIgPSB7CiAgICAgICAgICAgIFsxXSA9ICJDaGFuZ2UtQ2hhcHRlciIsCiAgICAgICAgICAgIFsyXSA9IHsKICAgICAgICAgICAgICAgIFsiQ2hhcHRlciJdID0gc2VsZWN0ZWRSYW5nZXJNYXAgLi4gIl8iIC4uIHNlbGVjdGVkQWN0CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJnczIpKQogICAgICAgIHdhaXQoMC41KQogICAgICAgIAogICAgICAgIC0tIDUuIFN1Ym1pdAogICAgICAgIEV2ZW50OkZpcmVTZXJ2ZXIoIlN1Ym1pdCIpCiAgICAgICAgd2FpdCgxKQogICAgICAgIAogICAgICAgIC0tIDYuIFN0YXJ0CiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcigiU3RhcnQiKQogICAgICAgIAogICAgICAgIHByaW50KCLEkMOjIGpvaW4gUmFuZ2VyIFN0YWdlOiAiIC4uIHNlbGVjdGVkUmFuZ2VyTWFwIC4uICJfIiAuLiBzZWxlY3RlZEFjdCkKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSBqb2luIFJhbmdlciBTdGFnZTogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICAKICAgIHJldHVybiB0cnVlCmVuZAoKLS0gVGltZSBEZWxheSBzbGlkZXIgY2hvIFN0b3J5ClN0b3J5U2VjdGlvbjpBZGRTbGlkZXIoIlN0b3J5VGltZURlbGF5U2xpZGVyIiwgewogICAgVGl0bGUgPSAiVGltZSBEZWxheSAoZ2nDonkpIiwKICAgIERlZmF1bHQgPSBzdG9yeVRpbWVEZWxheSwKICAgIE1pbiA9IDEsCiAgICBNYXggPSAzMCwKICAgIFJvdW5kaW5nID0gMSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgc3RvcnlUaW1lRGVsYXkgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlN0b3J5VGltZURlbGF5ID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgcHJpbnQoIsSQw6MgxJHhurd0IFN0b3J5IFRpbWUgRGVsYXk6ICIgLi4gVmFsdWUgLi4gIiBnacOieSIpCiAgICBlbmQKfSkKCi0tIERyb3Bkb3duIMSR4buDIGNo4buNbiBNYXAgY2hvIFJhbmdlcgpSYW5nZXJTZWN0aW9uOkFkZERyb3Bkb3duKCJSYW5nZXJNYXBEcm9wZG93biIsIHsKICAgIFRpdGxlID0gIkNob29zZSBNYXAiLAogICAgVmFsdWVzID0geyJWb29jaGEgVmlsbGFnZSIsICJHcmVlbiBQbGFuZXQiLCAiRGVtb24gRm9yZXN0IiwgIkxlYWYgVmlsbGFnZSIsICJaIENpdHkifSwKICAgIE11bHRpID0gZmFsc2UsCiAgICBEZWZhdWx0ID0gc2VsZWN0ZWRSYW5nZXJEaXNwbGF5TWFwLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBzZWxlY3RlZFJhbmdlckRpc3BsYXlNYXAgPSBWYWx1ZQogICAgICAgIHNlbGVjdGVkUmFuZ2VyTWFwID0gbWFwTmFtZU1hcHBpbmdbVmFsdWVdIG9yICJPbmVQaWVjZSIKICAgICAgICBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5TZWxlY3RlZFJhbmdlck1hcCA9IHNlbGVjdGVkUmFuZ2VyTWFwCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIAogICAgICAgIC0tIFRoYXkgxJHhu5VpIG1hcCBraGkgbmfGsOG7nWkgZMO5bmcgY2jhu41uCiAgICAgICAgY2hhbmdlV29ybGQoVmFsdWUpCiAgICAgICAgcHJpbnQoIsSQw6MgY2jhu41uIFJhbmdlciBtYXA6ICIgLi4gVmFsdWUgLi4gIiAodGjhu7FjIHThur86ICIgLi4gc2VsZWN0ZWRSYW5nZXJNYXAgLi4gIikiKQogICAgZW5kCn0pCgotLSBEcm9wZG93biDEkeG7gyBjaOG7jW4gQWN0ClJhbmdlclNlY3Rpb246QWRkRHJvcGRvd24oIkFjdERyb3Bkb3duIiwgewogICAgVGl0bGUgPSAiQ2hvb3NlIEFjdCIsCiAgICBWYWx1ZXMgPSB7IlJhbmdlclN0YWdlMSIsICJSYW5nZXJTdGFnZTIiLCAiUmFuZ2VyU3RhZ2UzIn0sCiAgICBNdWx0aSA9IGZhbHNlLAogICAgRGVmYXVsdCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlNlbGVjdGVkQWN0IG9yICJSYW5nZXJTdGFnZTEiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBzZWxlY3RlZEFjdCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuU2VsZWN0ZWRBY3QgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICAtLSBUaGF5IMSR4buVaSBhY3Qga2hpIG5nxrDhu51pIGTDuW5nIGNo4buNbgogICAgICAgIGNoYW5nZUFjdChzZWxlY3RlZFJhbmdlck1hcCwgVmFsdWUpCiAgICAgICAgcHJpbnQoIsSQw6MgY2jhu41uIGFjdDogIiAuLiBWYWx1ZSkKICAgIGVuZAp9KQoKLS0gVG9nZ2xlIEZyaWVuZCBPbmx5IGNobyBSYW5nZXIKUmFuZ2VyU2VjdGlvbjpBZGRUb2dnbGUoIlJhbmdlckZyaWVuZE9ubHlUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJGcmllbmQgT25seSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuUmFuZ2VyRnJpZW5kT25seSBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgcmFuZ2VyRnJpZW5kT25seSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuUmFuZ2VyRnJpZW5kT25seSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIAogICAgICAgIC0tIFRvZ2dsZSBGcmllbmQgT25seSBraGkgbmfGsOG7nWkgZMO5bmcgdGhheSDEkeG7lWkKICAgICAgICB0b2dnbGVSYW5nZXJGcmllbmRPbmx5KCkKICAgICAgICAKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiUmFuZ2VyIEZyaWVuZCBPbmx5IiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAixJDDoyBi4bqtdCBjaOG6vyDEkeG7mSBGcmllbmQgT25seSBjaG8gUmFuZ2VyIFN0YWdlIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJSYW5nZXIgRnJpZW5kIE9ubHkiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICLEkMOjIHThuq90IGNo4bq/IMSR4buZIEZyaWVuZCBPbmx5IGNobyBSYW5nZXIgU3RhZ2UiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAyCiAgICAgICAgICAgIH0pCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRpbWUgRGVsYXkgc2xpZGVyIGNobyBSYW5nZXIKUmFuZ2VyU2VjdGlvbjpBZGRTbGlkZXIoIlJhbmdlclRpbWVEZWxheVNsaWRlciIsIHsKICAgIFRpdGxlID0gIlRpbWUgRGVsYXkgKGdpw6J5KSIsCiAgICBEZWZhdWx0ID0gcmFuZ2VyVGltZURlbGF5LAogICAgTWluID0gMSwKICAgIE1heCA9IDMwLAogICAgUm91bmRpbmcgPSAxLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICByYW5nZXJUaW1lRGVsYXkgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLlJhbmdlclRpbWVEZWxheSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIHByaW50KCLEkMOjIMSR4bq3dCBSYW5nZXIgVGltZSBEZWxheTogIiAuLiBWYWx1ZSAuLiAiIGdpw6J5IikKICAgIGVuZAp9KQoKLS0gVG9nZ2xlIEF1dG8gSm9pbiBSYW5nZXIgU3RhZ2UKUmFuZ2VyU2VjdGlvbjpBZGRUb2dnbGUoIkF1dG9Kb2luUmFuZ2VyVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBKb2luIFJhbmdlciBTdGFnZSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5SYW5nZXIgb3IgZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGF1dG9Kb2luUmFuZ2VyRW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5SYW5nZXIgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBhdXRvSm9pblJhbmdlckVuYWJsZWQgdGhlbgogICAgICAgICAgICAtLSBLaeG7g20gdHJhIG5nYXkgbOG6rXAgdOG7qWMgbuG6v3UgbmfGsOG7nWkgY2jGoWkgxJFhbmcg4bufIHRyb25nIG1hcAogICAgICAgICAgICBpZiBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIFJhbmdlciBTdGFnZSIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICLEkGFuZyDhu58gdHJvbmcgbWFwLCBBdXRvIEpvaW4gUmFuZ2VyIHPhur0gaG/huqF0IMSR4buZbmcga2hpIGLhuqFuIHLhu51pIGto4buPaSBtYXAiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIFJhbmdlciBTdGFnZSIsCiAgICAgICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIEpvaW4gUmFuZ2VyIFN0YWdlIMSRw6MgxJHGsOG7o2MgYuG6rXQsIHPhur0gYuG6r3QgxJHhuqd1IHNhdSAiIC4uIHJhbmdlclRpbWVEZWxheSAuLiAiIGdpw6J5IiwKICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0tIFRo4buxYyBoaeG7h24gam9pbiBSYW5nZXIgU3RhZ2Ugc2F1IHRo4budaSBnaWFuIGRlbGF5CiAgICAgICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgd2FpdChyYW5nZXJUaW1lRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgaWYgYXV0b0pvaW5SYW5nZXJFbmFibGVkIGFuZCBub3QgaXNQbGF5ZXJJbk1hcCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgam9pblJhbmdlclN0YWdlKCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBU4bqhbyB2w7JuZyBs4bq3cCBBdXRvIEpvaW4gUmFuZ2VyIFN0YWdlCiAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9Kb2luUmFuZ2VyRW5hYmxlZCBhbmQgd2FpdCgxMCkgZG8gLS0gVGjhu60gam9pbiBtYXAgbeG7l2kgMTAgZ2nDonkKICAgICAgICAgICAgICAgICAgICAtLSBDaOG7iSB0aOG7sWMgaGnhu4duIGpvaW4gbWFwIG7hur91IG5nxrDhu51pIGNoxqFpIGtow7RuZyDhu58gdHJvbmcgbWFwCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIMOBcCBk4bulbmcgdGltZSBkZWxheQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgixJDhu6NpICIgLi4gcmFuZ2VyVGltZURlbGF5IC4uICIgZ2nDonkgdHLGsOG7m2Mga2hpIGpvaW4gUmFuZ2VyIFN0YWdlIikKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdChyYW5nZXJUaW1lRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAtLSBLaeG7g20gdHJhIGzhuqFpIHNhdSBraGkgZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXV0b0pvaW5SYW5nZXJFbmFibGVkIGFuZCBub3QgaXNQbGF5ZXJJbk1hcCgpIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5SYW5nZXJTdGFnZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgLS0gTmfGsOG7nWkgY2jGoWkgxJFhbmcg4bufIHRyb25nIG1hcCwga2jDtG5nIGPhuqduIGpvaW4KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIsSQYW5nIOG7nyB0cm9uZyBtYXAsIMSR4bujaSDEkeG6v24ga2hpIG5nxrDhu51pIGNoxqFpIHLhu51pIGto4buPaSBtYXAiKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBKb2luIFJhbmdlciBTdGFnZSIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gSm9pbiBSYW5nZXIgU3RhZ2UgxJHDoyDEkcaw4bujYyB04bqvdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDMKICAgICAgICAgICAgfSkKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gVGjDqm0gc2VjdGlvbiBCb3NzIEV2ZW50IHRyb25nIHRhYiBQbGF5CmxvY2FsIEJvc3NFdmVudFNlY3Rpb24gPSBQbGF5VGFiOkFkZFNlY3Rpb24oIkJvc3MgRXZlbnQiKQoKLS0gSMOgbSDEkeG7gyB0aGFtIGdpYSBCb3NzIEV2ZW50CmxvY2FsIGZ1bmN0aW9uIGpvaW5Cb3NzRXZlbnQoKQogICAgLS0gS2nhu4NtIHRyYSB4ZW0gbmfGsOG7nWkgY2jGoWkgxJHDoyDhu58gdHJvbmcgbWFwIGNoxrBhCiAgICBpZiBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgIHByaW50KCLEkMOjIHBow6F0IGhp4buHbiBuZ8aw4budaSBjaMahaSDEkWFuZyDhu58gdHJvbmcgbWFwLCBraMO0bmcgdGjhu7FjIGhp4buHbiBqb2luIEJvc3MgRXZlbnQiKQogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICAKICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAtLSBM4bqleSBFdmVudAogICAgICAgIGxvY2FsIEV2ZW50ID0gc2FmZUdldFBhdGgoZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpLCB7IlJlbW90ZSIsICJTZXJ2ZXIiLCAiUGxheVJvb20iLCAiRXZlbnQifSwgMikKICAgICAgICAKICAgICAgICBpZiBub3QgRXZlbnQgdGhlbgogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgRXZlbnQgxJHhu4MgdGhhbSBnaWEgQm9zcyBFdmVudCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIC0tIEfhu41pIEJvc3MgRXZlbnQKICAgICAgICBsb2NhbCBhcmdzID0gewogICAgICAgICAgICBbMV0gPSAiQm9zcy1FdmVudCIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgRXZlbnQ6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgcHJpbnQoIsSQw6MgZ+G7rWkgecOqdSBj4bqndSB0aGFtIGdpYSBCb3NzIEV2ZW50IikKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSB0aGFtIGdpYSBCb3NzIEV2ZW50OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHRydWUKZW5kCgotLSBUaW1lIERlbGF5IHNsaWRlciBjaG8gQm9zcyBFdmVudApCb3NzRXZlbnRTZWN0aW9uOkFkZFNsaWRlcigiQm9zc0V2ZW50VGltZURlbGF5U2xpZGVyIiwgewogICAgVGl0bGUgPSAiVGltZSBEZWxheSAoZ2nDonkpIiwKICAgIERlZmF1bHQgPSBib3NzRXZlbnRUaW1lRGVsYXksCiAgICBNaW4gPSAxLAogICAgTWF4ID0gMzAsCiAgICBSb3VuZGluZyA9IDEsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGJvc3NFdmVudFRpbWVEZWxheSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQm9zc0V2ZW50VGltZURlbGF5ID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgcHJpbnQoIsSQw6MgxJHhurd0IEJvc3MgRXZlbnQgVGltZSBEZWxheTogIiAuLiBWYWx1ZSAuLiAiIGdpw6J5IikKICAgIGVuZAp9KQoKLS0gVG9nZ2xlIEF1dG8gSm9pbiBCb3NzIEV2ZW50CkJvc3NFdmVudFNlY3Rpb246QWRkVG9nZ2xlKCJBdXRvSm9pbkJvc3NFdmVudFRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkF1dG8gQm9zcyBFdmVudCIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0Jvc3NFdmVudCBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgYXV0b0Jvc3NFdmVudEVuYWJsZWQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9Cb3NzRXZlbnQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBhdXRvQm9zc0V2ZW50RW5hYmxlZCB0aGVuCiAgICAgICAgICAgIC0tIEtp4buDbSB0cmEgbmdheSBs4bqtcCB04bupYyBu4bq/dSBuZ8aw4budaSBjaMahaSDEkWFuZyDhu58gdHJvbmcgbWFwCiAgICAgICAgICAgIGlmIGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIEJvc3MgRXZlbnQiLAogICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSAixJBhbmcg4bufIHRyb25nIG1hcCwgQXV0byBCb3NzIEV2ZW50IHPhur0gaG/huqF0IMSR4buZbmcga2hpIGLhuqFuIHLhu51pIGto4buPaSBtYXAiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBCb3NzIEV2ZW50IiwKICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gQm9zcyBFdmVudCDEkcOjIMSRxrDhu6NjIGLhuq10LCBz4bq9IGLhuq90IMSR4bqndSBzYXUgIiAuLiBib3NzRXZlbnRUaW1lRGVsYXkgLi4gIiBnacOieSIsCiAgICAgICAgICAgICAgICAgICAgRHVyYXRpb24gPSAzCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAtLSBUaOG7sWMgaGnhu4duIHRoYW0gZ2lhIEJvc3MgRXZlbnQgc2F1IHRo4budaSBnaWFuIGRlbGF5CiAgICAgICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgd2FpdChib3NzRXZlbnRUaW1lRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgaWYgYXV0b0Jvc3NFdmVudEVuYWJsZWQgYW5kIG5vdCBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICBqb2luQm9zc0V2ZW50KCkKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBU4bqhbyB2w7JuZyBs4bq3cCBBdXRvIEpvaW4gQm9zcyBFdmVudAogICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICB3aGlsZSBhdXRvQm9zc0V2ZW50RW5hYmxlZCBhbmQgd2FpdCgzMCkgZG8gLS0gVGjhu60gam9pbiBib3NzIGV2ZW50IG3hu5dpIDMwIGdpw6J5CiAgICAgICAgICAgICAgICAgICAgLS0gQ2jhu4kgdGjhu7FjIGhp4buHbiB0aGFtIGdpYSBu4bq/dSBuZ8aw4budaSBjaMahaSBraMO0bmcg4bufIHRyb25nIG1hcAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAtLSDDgXAgZOG7pW5nIHRpbWUgZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIsSQ4bujaSAiIC4uIGJvc3NFdmVudFRpbWVEZWxheSAuLiAiIGdpw6J5IHRyxrDhu5tjIGtoaSB0aGFtIGdpYSBCb3NzIEV2ZW50IikKICAgICAgICAgICAgICAgICAgICAgICAgd2FpdChib3NzRXZlbnRUaW1lRGVsYXkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAtLSBLaeG7g20gdHJhIGzhuqFpIHNhdSBraGkgZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgYXV0b0Jvc3NFdmVudEVuYWJsZWQgYW5kIG5vdCBpc1BsYXllckluTWFwKCkgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgam9pbkJvc3NFdmVudCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgLS0gTmfGsOG7nWkgY2jGoWkgxJFhbmcg4bufIHRyb25nIG1hcCwga2jDtG5nIGPhuqduIHRoYW0gZ2lhCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLEkGFuZyDhu58gdHJvbmcgbWFwLCDEkeG7o2kgxJHhur9uIGtoaSBuZ8aw4budaSBjaMahaSBy4budaSBraOG7j2kgbWFwIikKICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gQm9zcyBFdmVudCIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gQm9zcyBFdmVudCDEkcOjIMSRxrDhu6NjIHThuq90IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBUaMOqbSBzZWN0aW9uIEluLUdhbWUgQ29udHJvbHMKbG9jYWwgSW5HYW1lU2VjdGlvbiA9IEluR2FtZVRhYjpBZGRTZWN0aW9uKCJHYW1lIENvbnRyb2xzIikKCi0tIEjDoG0gxJHhu4Mga2nhu4NtIHRyYSB0cuG6oW5nIHRow6FpIEF1dG9QbGF5IHRo4buxYyB04bq/IHRyb25nIGdhbWUKbG9jYWwgZnVuY3Rpb24gY2hlY2tBY3R1YWxBdXRvUGxheVN0YXRlKCkKICAgIGxvY2FsIHN1Y2Nlc3MsIHJlc3VsdCA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBwbGF5ZXIgPSBnYW1lOkdldFNlcnZpY2UoIlBsYXllcnMiKS5Mb2NhbFBsYXllcgogICAgICAgIGlmIG5vdCBwbGF5ZXIgdGhlbiByZXR1cm4gZmFsc2UgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgcGxheWVyRGF0YSA9IGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKTpGaW5kRmlyc3RDaGlsZCgiUGxheWVyX0RhdGEiKQogICAgICAgIGlmIG5vdCBwbGF5ZXJEYXRhIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIAogICAgICAgIGxvY2FsIHBsYXllckZvbGRlciA9IHBsYXllckRhdGE6RmluZEZpcnN0Q2hpbGQocGxheWVyLk5hbWUpCiAgICAgICAgaWYgbm90IHBsYXllckZvbGRlciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCBkYXRhRm9sZGVyID0gcGxheWVyRm9sZGVyOkZpbmRGaXJzdENoaWxkKCJEYXRhIikKICAgICAgICBpZiBub3QgZGF0YUZvbGRlciB0aGVuIHJldHVybiBmYWxzZSBlbmQKICAgICAgICAKICAgICAgICBsb2NhbCBhdXRvUGxheVZhbHVlID0gZGF0YUZvbGRlcjpGaW5kRmlyc3RDaGlsZCgiQXV0b1BsYXkiKQogICAgICAgIGlmIG5vdCBhdXRvUGxheVZhbHVlIHRoZW4gcmV0dXJuIGZhbHNlIGVuZAogICAgICAgIAogICAgICAgIHJldHVybiBhdXRvUGxheVZhbHVlLlZhbHVlCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkga2nhu4NtIHRyYSB0cuG6oW5nIHRow6FpIEF1dG9QbGF5OiAiIC4uIHRvc3RyaW5nKHJlc3VsdCkpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHJlc3VsdAplbmQKCi0tIEjDoG0gxJHhu4MgYuG6rXQvdOG6r3QgQXV0byBQbGF5CmxvY2FsIGZ1bmN0aW9uIHRvZ2dsZUF1dG9QbGF5KCkKICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBBdXRvUGxheVJlbW90ZSA9IHNhZmVHZXRQYXRoKGdhbWU6R2V0U2VydmljZSgiUmVwbGljYXRlZFN0b3JhZ2UiKSwgeyJSZW1vdGUiLCAiU2VydmVyIiwgIlVuaXRzIiwgIkF1dG9QbGF5In0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgQXV0b1BsYXlSZW1vdGUgdGhlbgogICAgICAgICAgICBBdXRvUGxheVJlbW90ZTpGaXJlU2VydmVyKCkKICAgICAgICAgICAgcHJpbnQoIsSQw6MgdG9nZ2xlIEF1dG8gUGxheSIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUmVtb3RlIEF1dG9QbGF5IikKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSB0b2dnbGUgQXV0byBQbGF5OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBUb2dnbGUgQXV0byBQbGF5CkluR2FtZVNlY3Rpb246QWRkVG9nZ2xlKCJBdXRvUGxheVRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkF1dG8gUGxheSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1BsYXkgb3IgZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIC0tIEPhuq1wIG5o4bqtdCBj4bqldSBow6xuaAogICAgICAgIGF1dG9QbGF5RW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1BsYXkgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICAtLSBLaeG7g20gdHJhIHRy4bqhbmcgdGjDoWkgdGjhu7FjIHThur8gY+G7p2EgQXV0b1BsYXkKICAgICAgICBsb2NhbCBhY3R1YWxTdGF0ZSA9IGNoZWNrQWN0dWFsQXV0b1BsYXlTdGF0ZSgpCiAgICAgICAgCiAgICAgICAgLS0gQ2jhu4kgdG9nZ2xlIGtoaSB0cuG6oW5nIHRow6FpIG1vbmcgbXXhu5FuIGtow6FjIHbhu5tpIHRy4bqhbmcgdGjDoWkgaGnhu4duIHThuqFpCiAgICAgICAgaWYgVmFsdWUgfj0gYWN0dWFsU3RhdGUgdGhlbgogICAgICAgICAgICB0b2dnbGVBdXRvUGxheSgpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIFBsYXkiLAogICAgICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBQbGF5IMSRw6MgxJHGsOG7o2MgYuG6rXQiLAogICAgICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBQbGF5IiwKICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gUGxheSDEkcOjIMSRxrDhu6NjIHThuq90IiwKICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGVuZAogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIFBsYXkiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJUcuG6oW5nIHRow6FpIEF1dG8gUGxheSDEkcOjIHBow7kgaOG7o3AgKCIgLi4gKFZhbHVlIGFuZCAiYuG6rXQiIG9yICJ04bqvdCIpIC4uICIpIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBIw6BtIMSR4buDIGLhuq10L3Thuq90IEF1dG8gUmV0cnkKbG9jYWwgZnVuY3Rpb24gdG9nZ2xlQXV0b1JldHJ5KCkKICAgIGxvY2FsIHN1Y2Nlc3MsIGVyciA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBBdXRvUmV0cnlSZW1vdGUgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJPbkdhbWUiLCAiVm90aW5nIiwgIlZvdGVSZXRyeSJ9LCAyKQogICAgICAgIAogICAgICAgIGlmIEF1dG9SZXRyeVJlbW90ZSB0aGVuCiAgICAgICAgICAgIEF1dG9SZXRyeVJlbW90ZTpGaXJlU2VydmVyKCkKICAgICAgICAgICAgcHJpbnQoIsSQw6MgdG9nZ2xlIEF1dG8gUmV0cnkiKQogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IFJlbW90ZSBWb3RlUmV0cnkiKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBpZiBub3Qgc3VjY2VzcyB0aGVuCiAgICAgICAgd2FybigiTOG7l2kga2hpIHRvZ2dsZSBBdXRvIFJldHJ5OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBIw6BtIMSR4buDIGLhuq10L3Thuq90IEF1dG8gTmV4dApsb2NhbCBmdW5jdGlvbiB0b2dnbGVBdXRvTmV4dCgpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgQXV0b05leHRSZW1vdGUgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJPbkdhbWUiLCAiVm90aW5nIiwgIlZvdGVOZXh0In0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgQXV0b05leHRSZW1vdGUgdGhlbgogICAgICAgICAgICBBdXRvTmV4dFJlbW90ZTpGaXJlU2VydmVyKCkKICAgICAgICAgICAgcHJpbnQoIsSQw6MgdG9nZ2xlIEF1dG8gTmV4dCIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUmVtb3RlIFZvdGVOZXh0IikKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSB0b2dnbGUgQXV0byBOZXh0OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBIw6BtIMSR4buDIGLhuq10L3Thuq90IEF1dG8gVm90ZQpsb2NhbCBmdW5jdGlvbiB0b2dnbGVBdXRvVm90ZSgpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgQXV0b1ZvdGVSZW1vdGUgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJPbkdhbWUiLCAiVm90aW5nIiwgIlZvdGVQbGF5aW5nIn0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgQXV0b1ZvdGVSZW1vdGUgdGhlbgogICAgICAgICAgICBBdXRvVm90ZVJlbW90ZTpGaXJlU2VydmVyKCkKICAgICAgICAgICAgcHJpbnQoIsSQw6MgdG9nZ2xlIEF1dG8gVm90ZSIpCiAgICAgICAgZWxzZQogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgUmVtb3RlIFZvdGVQbGF5aW5nIikKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSB0b2dnbGUgQXV0byBWb3RlOiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICBlbmQKZW5kCgotLSBUb2dnbGUgQXV0byBSZXRyeQpJbkdhbWVTZWN0aW9uOkFkZFRvZ2dsZSgiQXV0b1JldHJ5VG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBSZXRyeSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1JldHJ5IG9yIGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBhdXRvUmV0cnlFbmFibGVkID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvUmV0cnkgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBSZXRyeSIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gUmV0cnkgxJHDoyDEkcaw4bujYyBi4bqtdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEjhu6d5IHbDsm5nIGzhurdwIGPFqSBu4bq/dSBjw7MKICAgICAgICAgICAgaWYgYXV0b1JldHJ5TG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvUmV0cnlMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b1JldHJ5TG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFThuqFvIHbDsm5nIGzhurdwIG3hu5tpCiAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9SZXRyeUVuYWJsZWQgYW5kIHdhaXQoMykgZG8gLS0gR+G7rWkgecOqdSBj4bqndSBt4buXaSAzIGdpw6J5CiAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQXV0b1JldHJ5KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gUmV0cnkiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFJldHJ5IMSRw6MgxJHGsOG7o2MgdOG6r3QiLAogICAgICAgICAgICAgICAgRHVyYXRpb24gPSAyCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBI4buneSB2w7JuZyBs4bq3cCBu4bq/dSBjw7MKICAgICAgICAgICAgaWYgYXV0b1JldHJ5TG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvUmV0cnlMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b1JldHJ5TG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZAp9KQoKLS0gVG9nZ2xlIEF1dG8gTmV4dApJbkdhbWVTZWN0aW9uOkFkZFRvZ2dsZSgiQXV0b05leHRUb2dnbGUiLCB7CiAgICBUaXRsZSA9ICJBdXRvIE5leHQiLAogICAgRGVmYXVsdCA9IENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9OZXh0IG9yIGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBhdXRvTmV4dEVuYWJsZWQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9OZXh0ID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgCiAgICAgICAgaWYgVmFsdWUgdGhlbgogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gTmV4dCIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gTmV4dCDEkcOjIMSRxrDhu6NjIGLhuq10IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgY8WpIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvTmV4dExvb3AgdGhlbgogICAgICAgICAgICAgICAgYXV0b05leHRMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b05leHRMb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVOG6oW8gdsOybmcgbOG6t3AgbeG7m2kKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b05leHRFbmFibGVkIGFuZCB3YWl0KDMpIGRvIC0tIEfhu61pIHnDqnUgY+G6p3UgbeG7l2kgMyBnacOieQogICAgICAgICAgICAgICAgICAgIHRvZ2dsZUF1dG9OZXh0KCkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBlbmQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gTmV4dCIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gTmV4dCDEkcOjIMSRxrDhu6NjIHThuq90IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgbuG6v3UgY8OzCiAgICAgICAgICAgIGlmIGF1dG9OZXh0TG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvTmV4dExvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBhdXRvTmV4dExvb3AgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBBdXRvIFZvdGUKSW5HYW1lU2VjdGlvbjpBZGRUb2dnbGUoIkF1dG9Wb3RlVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBWb3RlIiwKICAgIERlZmF1bHQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvVm90ZSBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgYXV0b1ZvdGVFbmFibGVkID0gVmFsdWUKICAgICAgICBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvVm90ZSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIAogICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIFZvdGUiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFZvdGUgxJHDoyDEkcaw4bujYyBi4bqtdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEjhu6d5IHbDsm5nIGzhurdwIGPFqSBu4bq/dSBjw7MKICAgICAgICAgICAgaWYgYXV0b1ZvdGVMb29wIHRoZW4KICAgICAgICAgICAgICAgIGF1dG9Wb3RlTG9vcDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGF1dG9Wb3RlTG9vcCA9IG5pbAogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIFThuqFvIHbDsm5nIGzhurdwIG3hu5tpCiAgICAgICAgICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICAgICAgICAgIHdoaWxlIGF1dG9Wb3RlRW5hYmxlZCBhbmQgd2FpdCgzKSBkbyAtLSBH4butaSB5w6p1IGPhuqd1IG3hu5dpIDMgZ2nDonkKICAgICAgICAgICAgICAgICAgICB0b2dnbGVBdXRvVm90ZSgpCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIFZvdGUiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFZvdGUgxJHDoyDEkcaw4bujYyB04bqvdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEjhu6d5IHbDsm5nIGzhurdwIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvVm90ZUxvb3AgdGhlbgogICAgICAgICAgICAgICAgYXV0b1ZvdGVMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b1ZvdGVMb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBIw6BtIMSR4buDIHNjYW4gdW5pdCB0cm9uZyBVbml0c0ZvbGRlcgpsb2NhbCBmdW5jdGlvbiBzY2FuVW5pdHMoKQogICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIC0tIEzhuqV5IFVuaXRzRm9sZGVyCiAgICAgICAgbG9jYWwgcGxheWVyID0gZ2FtZTpHZXRTZXJ2aWNlKCJQbGF5ZXJzIikuTG9jYWxQbGF5ZXIKICAgICAgICBpZiBub3QgcGxheWVyIHRoZW4KICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IExvY2FsUGxheWVyIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgdW5pdHNGb2xkZXIgPSBwbGF5ZXI6RmluZEZpcnN0Q2hpbGQoIlVuaXRzRm9sZGVyIikKICAgICAgICBpZiBub3QgdW5pdHNGb2xkZXIgdGhlbgogICAgICAgICAgICB3YXJuKCJLaMO0bmcgdMOsbSB0aOG6pXkgVW5pdHNGb2xkZXIiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBM4bqleSBkYW5oIHPDoWNoIHVuaXQgdGhlbyB0aOG7qSB04buxCiAgICAgICAgbG9jYWwgdW5pdHMgPSB7fQogICAgICAgIGZvciBfLCB1bml0IGluIGlwYWlycyh1bml0c0ZvbGRlcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgICAgICBpZiB1bml0OklzQSgiRm9sZGVyIikgb3IgdW5pdDpJc0EoIk1vZGVsIikgdGhlbgogICAgICAgICAgICAgICAgdGFibGUuaW5zZXJ0KHVuaXRzLCB1bml0KQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICAKICAgICAgICAtLSBHw6FuIHVuaXQgdsOgbyBzbG90CiAgICAgICAgdW5pdFNsb3RzID0ge30KICAgICAgICBmb3IgaSwgdW5pdCBpbiBpcGFpcnModW5pdHMpIGRvCiAgICAgICAgICAgIGlmIGkgPD0gNiB0aGVuIC0tIEdp4bubaSBo4bqhbiA2IHNsb3QKICAgICAgICAgICAgICAgIHVuaXRTbG90c1tpXSA9IHVuaXQKICAgICAgICAgICAgICAgIHByaW50KCJTbG90ICIgLi4gaSAuLiAiOiAiIC4uIHVuaXQuTmFtZSkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcmV0dXJuICN1bml0U2xvdHMgPiAwCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgc2NhbiB1bml0czogIiAuLiB0b3N0cmluZyhlcnIpKQogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCiAgICAKICAgIHJldHVybiBzdWNjZXNzCmVuZAoKLS0gSMOgbSDEkeG7gyBuw6JuZyBj4bqlcCB1bml0CmxvY2FsIGZ1bmN0aW9uIHVwZ3JhZGVVbml0KHVuaXQpCiAgICBpZiBub3QgdW5pdCB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIAogICAgbG9jYWwgc3VjY2VzcywgZXJyID0gcGNhbGwoZnVuY3Rpb24oKQogICAgICAgIGxvY2FsIHVwZ3JhZGVSZW1vdGUgPSBzYWZlR2V0UGF0aChnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIiksIHsiUmVtb3RlIiwgIlNlcnZlciIsICJVbml0cyIsICJVcGdyYWRlIn0sIDIpCiAgICAgICAgCiAgICAgICAgaWYgdXBncmFkZVJlbW90ZSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGFyZ3MgPSB7CiAgICAgICAgICAgICAgICBbMV0gPSB1bml0CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHVwZ3JhZGVSZW1vdGU6RmlyZVNlcnZlcih1bnBhY2soYXJncykpCiAgICAgICAgICAgIHByaW50KCLEkMOjIG7Dom5nIGPhuqVwIHVuaXQ6ICIgLi4gdW5pdC5OYW1lKQogICAgICAgIGVsc2UKICAgICAgICAgICAgd2FybigiS2jDtG5nIHTDrG0gdGjhuqV5IFJlbW90ZSBVcGdyYWRlIikKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgaWYgbm90IHN1Y2Nlc3MgdGhlbgogICAgICAgIHdhcm4oIkzhu5dpIGtoaSBuw6JuZyBj4bqlcCB1bml0OiAiIC4uIHRvc3RyaW5nKGVycikpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHRydWUKZW5kCgotLSBUaMOqbSBzZWN0aW9uIFVuaXRzIFVwZGF0ZSB0cm9uZyB0YWIgSW4tR2FtZQpsb2NhbCBVbml0c1VwZGF0ZVNlY3Rpb24gPSBJbkdhbWVUYWI6QWRkU2VjdGlvbigiVW5pdHMgVXBkYXRlIikKCi0tIE7DunQgU2NhbiBVbml0cwpVbml0c1VwZGF0ZVNlY3Rpb246QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIlNjYW4gVW5pdHMiLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbigpCiAgICAgICAgbG9jYWwgc3VjY2VzcyA9IHNjYW5Vbml0cygpCiAgICAgICAgCiAgICAgICAgaWYgc3VjY2VzcyB0aGVuCiAgICAgICAgICAgIGxvY2FsIHVuaXRJbmZvID0gIlBow6F0IGhp4buHbiAiIC4uICN1bml0U2xvdHMgLi4gIiB1bml0OlxuIgogICAgICAgICAgICBmb3IgaSwgdW5pdCBpbiBpcGFpcnModW5pdFNsb3RzKSBkbwogICAgICAgICAgICAgICAgdW5pdEluZm8gPSB1bml0SW5mbyAuLiAiU2xvdCAiIC4uIGkgLi4gIjogIiAuLiB1bml0Lk5hbWUgLi4gIlxuIgogICAgICAgICAgICBlbmQKICAgICAgICAgICAgCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiU2NhbiBVbml0cyIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gdW5pdEluZm8sCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDUKICAgICAgICAgICAgfSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiU2NhbiBVbml0cyIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIktow7RuZyB0w6xtIHRo4bqleSB1bml0IG7DoG8uIEjDo3kgxJHhuqNtIGLhuqNvIGLhuqFuIMSRYW5nIOG7nyB0cm9uZyBtYXAuIiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMwogICAgICAgICAgICB9KQogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBU4bqhbyA2IGRyb3Bkb3duIGNobyA2IHNsb3QKZm9yIGkgPSAxLCA2IGRvCiAgICBVbml0c1VwZGF0ZVNlY3Rpb246QWRkRHJvcGRvd24oIlNsb3QiIC4uIGkgLi4gIkxldmVsRHJvcGRvd24iLCB7CiAgICAgICAgVGl0bGUgPSAiU2xvdCAiIC4uIGkgLi4gIiBMZXZlbCIsCiAgICAgICAgVmFsdWVzID0geyIwIiwgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiwgIjciLCAiOCIsICI5IiwgIjEwIn0sCiAgICAgICAgTXVsdGkgPSBmYWxzZSwKICAgICAgICBEZWZhdWx0ID0gdG9zdHJpbmcodW5pdFNsb3RMZXZlbHNbaV0pLAogICAgICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgICAgIC0tIENodXnhu4NuIMSR4buVaSBnacOhIHRy4buLIHRow6BuaCBz4buRCiAgICAgICAgICAgIGxvY2FsIG51bWJlclZhbHVlID0gdG9udW1iZXIoVmFsdWUpCiAgICAgICAgICAgIGlmIG5vdCBudW1iZXJWYWx1ZSB0aGVuCiAgICAgICAgICAgICAgICBudW1iZXJWYWx1ZSA9IDAKICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIAogICAgICAgICAgICB1bml0U2xvdExldmVsc1tpXSA9IG51bWJlclZhbHVlCiAgICAgICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnWyJTbG90IiAuLiBpIC4uICJMZXZlbCJdID0gbnVtYmVyVmFsdWUKICAgICAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgICAgICAKICAgICAgICAgICAgcHJpbnQoIsSQw6MgxJHhurd0IGPhuqVwIMSR4buZIHNsb3QgIiAuLiBpIC4uICIgdGjDoG5oOiAiIC4uIG51bWJlclZhbHVlKQogICAgICAgIGVuZAogICAgfSkKZW5kCgotLSBUb2dnbGUgQXV0byBVcGRhdGUKVW5pdHNVcGRhdGVTZWN0aW9uOkFkZFRvZ2dsZSgiQXV0b1VwZGF0ZVRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkF1dG8gVXBkYXRlIiwKICAgIERlZmF1bHQgPSBDb25maWdTeXN0ZW0uQ3VycmVudENvbmZpZy5BdXRvVXBkYXRlIG9yIGZhbHNlLAogICAgQ2FsbGJhY2sgPSBmdW5jdGlvbihWYWx1ZSkKICAgICAgICBhdXRvVXBkYXRlRW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1VwZGF0ZSA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLlNhdmVDb25maWcoKQogICAgICAgIAogICAgICAgIGlmIFZhbHVlIHRoZW4KICAgICAgICAgICAgLS0gU2NhbiB1bml0IHRyxrDhu5tjIGtoaSBi4bqvdCDEkeG6p3UKICAgICAgICAgICAgc2NhblVuaXRzKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBVcGRhdGUiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFVwZGF0ZSDEkcOjIMSRxrDhu6NjIGLhuq10IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgY8WpIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvVXBkYXRlTG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvVXBkYXRlTG9vcDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGF1dG9VcGRhdGVMb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVOG6oW8gdsOybmcgbOG6t3AgbeG7m2kKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b1VwZGF0ZUVuYWJsZWQgYW5kIHdhaXQoMikgZG8gLS0gQ+G6rXAgbmjhuq10IG3hu5dpIDIgZ2nDonkKICAgICAgICAgICAgICAgICAgICAtLSBLaeG7g20gdHJhIHhlbSBjw7MgdHJvbmcgbWFwIGtow7RuZwogICAgICAgICAgICAgICAgICAgIGlmIGlzUGxheWVySW5NYXAoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIEzhurdwIHF1YSB04burbmcgc2xvdCB2w6AgbsOibmcgY+G6pXAgdGhlbyBj4bqlcCDEkeG7mSDEkcOjIGNo4buNbgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSA9IDEsIDYgZG8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHVuaXRTbG90c1tpXSBhbmQgdW5pdFNsb3RMZXZlbHNbaV0gPiAwIHRoZW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgaiA9IDEsIHVuaXRTbG90TGV2ZWxzW2ldIGRvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZ3JhZGVVbml0KHVuaXRTbG90c1tpXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjEpIC0tIENo4budIG3hu5l0IGNow7p0IGdp4buvYSBjw6FjIGzhuqduIG7Dom5nIGPhuqVwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAtLSBOZ8aw4budaSBjaMahaSBraMO0bmcg4bufIHRyb25nIG1hcCwgdGjhu60gc2NhbiBs4bqhaQogICAgICAgICAgICAgICAgICAgICAgICBzY2FuVW5pdHMoKQogICAgICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgIGVuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQXV0byBVcGRhdGUiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFVwZGF0ZSDEkcOjIMSRxrDhu6NjIHThuq90IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgbuG6v3UgY8OzCiAgICAgICAgICAgIGlmIGF1dG9VcGRhdGVMb29wIHRoZW4KICAgICAgICAgICAgICAgIGF1dG9VcGRhdGVMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b1VwZGF0ZUxvb3AgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIFRvZ2dsZSBBdXRvIFVwZGF0ZSBSYW5kb20KVW5pdHNVcGRhdGVTZWN0aW9uOkFkZFRvZ2dsZSgiQXV0b1VwZGF0ZVJhbmRvbVRvZ2dsZSIsIHsKICAgIFRpdGxlID0gIkF1dG8gVXBkYXRlIFJhbmRvbSIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b1VwZGF0ZVJhbmRvbSBvciBmYWxzZSwKICAgIENhbGxiYWNrID0gZnVuY3Rpb24oVmFsdWUpCiAgICAgICAgYXV0b1VwZGF0ZVJhbmRvbUVuYWJsZWQgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9VcGRhdGVSYW5kb20gPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIC0tIFNjYW4gdW5pdCB0csaw4bubYyBraGkgYuG6r3QgxJHhuqd1CiAgICAgICAgICAgIHNjYW5Vbml0cygpCiAgICAgICAgICAgIAogICAgICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgICAgIFRpdGxlID0gIkF1dG8gVXBkYXRlIFJhbmRvbSIsCiAgICAgICAgICAgICAgICBDb250ZW50ID0gIkF1dG8gVXBkYXRlIFJhbmRvbSDEkcOjIMSRxrDhu6NjIGLhuq10IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgY8WpIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvVXBkYXRlUmFuZG9tTG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvVXBkYXRlUmFuZG9tTG9vcDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGF1dG9VcGRhdGVSYW5kb21Mb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVOG6oW8gdsOybmcgbOG6t3AgbeG7m2kKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b1VwZGF0ZVJhbmRvbUVuYWJsZWQgYW5kIHdhaXQoMikgZG8gLS0gQ+G6rXAgbmjhuq10IG3hu5dpIDIgZ2nDonkKICAgICAgICAgICAgICAgICAgICAtLSBLaeG7g20gdHJhIHhlbSBjw7MgdHJvbmcgbWFwIGtow7RuZwogICAgICAgICAgICAgICAgICAgIGlmIGlzUGxheWVySW5NYXAoKSBhbmQgI3VuaXRTbG90cyA+IDAgdGhlbgogICAgICAgICAgICAgICAgICAgICAgICAtLSBDaOG7jW4gbmfhuqt1IG5oacOqbiBt4buZdCBzbG90IMSR4buDIG7Dom5nIGPhuqVwCiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsIHJhbmRvbUluZGV4ID0gbWF0aC5yYW5kb20oMSwgI3VuaXRTbG90cykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgdW5pdFNsb3RzW3JhbmRvbUluZGV4XSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGdyYWRlVW5pdCh1bml0U2xvdHNbcmFuZG9tSW5kZXhdKQogICAgICAgICAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIC0tIE5nxrDhu51pIGNoxqFpIGtow7RuZyDhu58gdHJvbmcgbWFwLCB0aOG7rSBzY2FuIGzhuqFpCiAgICAgICAgICAgICAgICAgICAgICAgIHNjYW5Vbml0cygpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIFVwZGF0ZSBSYW5kb20iLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJBdXRvIFVwZGF0ZSBSYW5kb20gxJHDoyDEkcaw4bujYyB04bqvdCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIEjhu6d5IHbDsm5nIGzhurdwIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvVXBkYXRlUmFuZG9tTG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvVXBkYXRlUmFuZG9tTG9vcDpEaXNjb25uZWN0KCkKICAgICAgICAgICAgICAgIGF1dG9VcGRhdGVSYW5kb21Mb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgIGVuZAogICAgZW5kCn0pCgotLSBU4buxIMSR4buZbmcgc2NhbiB1bml0IGtoaSBi4bqvdCDEkeG6p3UKc3Bhd24oZnVuY3Rpb24oKQogICAgd2FpdCg1KSAtLSDEkOG7o2kgNSBnacOieSDEkeG7gyBnYW1lIGxvYWQKICAgIHNjYW5Vbml0cygpCmVuZCkKCi0tIFThu7EgxJHhu5luZyBj4bqtcCBuaOG6rXQgdHLhuqFuZyB0aMOhaSB04burIGdhbWUga2hpIGto4bufaSDEkeG7mW5nCnNwYXduKGZ1bmN0aW9uKCkKICAgIHdhaXQoMykgLS0gxJDhu6NpIGdhbWUgbG9hZAogICAgbG9jYWwgYWN0dWFsU3RhdGUgPSBjaGVja0FjdHVhbEF1dG9QbGF5U3RhdGUoKQogICAgCiAgICAtLSBD4bqtcCBuaOG6rXQgY+G6pXUgaMOsbmggbuG6v3UgdHLhuqFuZyB0aMOhaSB0aOG7sWMgdOG6vyBraMOhYyB24bubaSBj4bqldSBow6xuaAogICAgaWYgYXV0b1BsYXlFbmFibGVkIH49IGFjdHVhbFN0YXRlIHRoZW4KICAgICAgICBhdXRvUGxheUVuYWJsZWQgPSBhY3R1YWxTdGF0ZQogICAgICAgIENvbmZpZ1N5c3RlbS5DdXJyZW50Q29uZmlnLkF1dG9QbGF5ID0gYWN0dWFsU3RhdGUKICAgICAgICBDb25maWdTeXN0ZW0uU2F2ZUNvbmZpZygpCiAgICAgICAgCiAgICAgICAgLS0gQ+G6rXAgbmjhuq10IFVJIG7hur91IGPhuqduCiAgICAgICAgbG9jYWwgYXV0b1BsYXlUb2dnbGUgPSBJbkdhbWVTZWN0aW9uOkdldENvbXBvbmVudCgiQXV0b1BsYXlUb2dnbGUiKQogICAgICAgIGlmIGF1dG9QbGF5VG9nZ2xlIGFuZCBhdXRvUGxheVRvZ2dsZS5TZXQgdGhlbgogICAgICAgICAgICBhdXRvUGxheVRvZ2dsZTpTZXQoYWN0dWFsU3RhdGUpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgcHJpbnQoIsSQw6MgY+G6rXAgbmjhuq10IHRy4bqhbmcgdGjDoWkgQXV0byBQbGF5IHThu6sgZ2FtZTogIiAuLiAoYWN0dWFsU3RhdGUgYW5kICJi4bqtdCIgb3IgInThuq90IikpCiAgICBlbmQKZW5kKQoKLS0gSMOgbSDEkeG7gyBraeG7g20gdHJhIHRy4bqhbmcgdGjDoWkgQUZLV29ybGQKbG9jYWwgZnVuY3Rpb24gY2hlY2tBRktXb3JsZFN0YXRlKCkKICAgIGxvY2FsIHN1Y2Nlc3MsIHJlc3VsdCA9IHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBhZmtXb3JsZFZhbHVlID0gZ2FtZTpHZXRTZXJ2aWNlKCJSZXBsaWNhdGVkU3RvcmFnZSIpOldhaXRGb3JDaGlsZCgiVmFsdWVzIiwgMSk6V2FpdEZvckNoaWxkKCJBRktXb3JsZCIsIDEpCiAgICAgICAgaWYgYWZrV29ybGRWYWx1ZSB0aGVuCiAgICAgICAgICAgIHJldHVybiBhZmtXb3JsZFZhbHVlLlZhbHVlCiAgICAgICAgZW5kCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkga2nhu4NtIHRyYSB0cuG6oW5nIHRow6FpIEFGS1dvcmxkOiAiIC4uIHRvc3RyaW5nKHJlc3VsdCkpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKICAgIAogICAgcmV0dXJuIHJlc3VsdAplbmQKCi0tIEjDoG0gxJHhu4MgdGhhbSBnaWEgQUZLIFdvcmxkCmxvY2FsIGZ1bmN0aW9uIGpvaW5BRktXb3JsZCgpCiAgICBsb2NhbCBzdWNjZXNzLCBlcnIgPSBwY2FsbChmdW5jdGlvbigpCiAgICAgICAgLS0gS2nhu4NtIHRyYSBu4bq/dSBuZ8aw4budaSBjaMahaSDEkcOjIOG7nyBBRktXb3JsZAogICAgICAgIGlmIGNoZWNrQUZLV29ybGRTdGF0ZSgpIHRoZW4KICAgICAgICAgICAgcHJpbnQoIk5nxrDhu51pIGNoxqFpIMSRw6Mg4bufIHRyb25nIEFGS1dvcmxkIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgYWZrVGVsZXBvcnRSZW1vdGUgPSBnYW1lOkdldFNlcnZpY2UoIlJlcGxpY2F0ZWRTdG9yYWdlIik6V2FpdEZvckNoaWxkKCJSZW1vdGUiLCAxKTpXYWl0Rm9yQ2hpbGQoIlNlcnZlciIsIDEpOldhaXRGb3JDaGlsZCgiTG9iYnkiLCAxKTpXYWl0Rm9yQ2hpbGQoIkFGS1dvcmxkVGVsZXBvcnQiLCAxKQogICAgICAgIAogICAgICAgIGlmIGFma1RlbGVwb3J0UmVtb3RlIHRoZW4KICAgICAgICAgICAgYWZrVGVsZXBvcnRSZW1vdGU6RmlyZVNlcnZlcigpCiAgICAgICAgICAgIHByaW50KCLEkMOjIGfhu61pIHnDqnUgY+G6p3UgdGVsZXBvcnQgxJHhur9uIEFGS1dvcmxkIikKICAgICAgICBlbHNlCiAgICAgICAgICAgIHdhcm4oIktow7RuZyB0w6xtIHRo4bqleSBSZW1vdGUgQUZLV29ybGRUZWxlcG9ydCIpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIGlmIG5vdCBzdWNjZXNzIHRoZW4KICAgICAgICB3YXJuKCJM4buXaSBraGkgdGhhbSBnaWEgQUZLV29ybGQ6ICIgLi4gdG9zdHJpbmcoZXJyKSkKICAgIGVuZAplbmQKCi0tIFRow6ptIHNlY3Rpb24gQUZLIHbDoG8gdGFiIFNldHRpbmdzCmxvY2FsIEFGS1NlY3Rpb24gPSBTZXR0aW5nc1RhYjpBZGRTZWN0aW9uKCJBRksgU2V0dGluZ3MiKQoKLS0gVG9nZ2xlIEF1dG8gSm9pbiBBRksKQUZLU2VjdGlvbjpBZGRUb2dnbGUoIkF1dG9Kb2luQUZLVG9nZ2xlIiwgewogICAgVGl0bGUgPSAiQXV0byBKb2luIEFGSyIsCiAgICBEZWZhdWx0ID0gQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5BRksgb3IgZmFsc2UsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKFZhbHVlKQogICAgICAgIGF1dG9Kb2luQUZLRW5hYmxlZCA9IFZhbHVlCiAgICAgICAgQ29uZmlnU3lzdGVtLkN1cnJlbnRDb25maWcuQXV0b0pvaW5BRksgPSBWYWx1ZQogICAgICAgIENvbmZpZ1N5c3RlbS5TYXZlQ29uZmlnKCkKICAgICAgICAKICAgICAgICBpZiBWYWx1ZSB0aGVuCiAgICAgICAgICAgIC0tIEtp4buDbSB0cmEgdHLhuqFuZyB0aMOhaSBBRktXb3JsZAogICAgICAgICAgICBsb2NhbCBpc0luQUZLV29ybGQgPSBjaGVja0FGS1dvcmxkU3RhdGUoKQogICAgICAgICAgICAKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIEpvaW4gQUZLIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBKb2luIEFGSyDEkcOjIMSRxrDhu6NjIGLhuq10IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gTuG6v3Uga2jDtG5nIOG7nyB0cm9uZyBBRktXb3JsZCwgdGVsZXBvcnQgbmdheSBs4bqtcCB04bupYwogICAgICAgICAgICBpZiBub3QgaXNJbkFGS1dvcmxkIHRoZW4KICAgICAgICAgICAgICAgIGpvaW5BRktXb3JsZCgpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgICAgIFRpdGxlID0gIkFGS1dvcmxkIiwKICAgICAgICAgICAgICAgICAgICBDb250ZW50ID0gIkLhuqFuIMSRw6Mg4bufIHRyb25nIEFGS1dvcmxkIiwKICAgICAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgY8WpIG7hur91IGPDswogICAgICAgICAgICBpZiBhdXRvSm9pbkFGS0xvb3AgdGhlbgogICAgICAgICAgICAgICAgYXV0b0pvaW5BRktMb29wOkRpc2Nvbm5lY3QoKQogICAgICAgICAgICAgICAgYXV0b0pvaW5BRktMb29wID0gbmlsCiAgICAgICAgICAgIGVuZAogICAgICAgICAgICAKICAgICAgICAgICAgLS0gVOG6oW8gdsOybmcgbOG6t3AgbeG7m2kKICAgICAgICAgICAgc3Bhd24oZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgd2hpbGUgYXV0b0pvaW5BRktFbmFibGVkIGFuZCB3YWl0KDYwKSBkbyAtLSBLaeG7g20gdHJhIG3hu5dpIDYwIGdpw6J5CiAgICAgICAgICAgICAgICAgICAgLS0gQ2jhu4kgdGVsZXBvcnQgbuG6v3Uga2jDtG5nIOG7nyB0cm9uZyBBRktXb3JsZAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBjaGVja0FGS1dvcmxkU3RhdGUoKSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgIGpvaW5BRktXb3JsZCgpCiAgICAgICAgICAgICAgICAgICAgZW5kCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZW5kKQogICAgICAgIGVsc2UKICAgICAgICAgICAgRmx1ZW50Ok5vdGlmeSh7CiAgICAgICAgICAgICAgICBUaXRsZSA9ICJBdXRvIEpvaW4gQUZLIiwKICAgICAgICAgICAgICAgIENvbnRlbnQgPSAiQXV0byBKb2luIEFGSyDEkcOjIMSRxrDhu6NjIHThuq90IiwKICAgICAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgLS0gSOG7p3kgdsOybmcgbOG6t3AgbuG6v3UgY8OzCiAgICAgICAgICAgIGlmIGF1dG9Kb2luQUZLTG9vcCB0aGVuCiAgICAgICAgICAgICAgICBhdXRvSm9pbkFGS0xvb3A6RGlzY29ubmVjdCgpCiAgICAgICAgICAgICAgICBhdXRvSm9pbkFGS0xvb3AgPSBuaWwKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQKfSkKCi0tIE7DunQgSm9pbiBBRksgTm93CkFGS1NlY3Rpb246QWRkQnV0dG9uKHsKICAgIFRpdGxlID0gIkpvaW4gQUZLIE5vdyIsCiAgICBDYWxsYmFjayA9IGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBpc0luQUZLV29ybGQgPSBjaGVja0FGS1dvcmxkU3RhdGUoKQogICAgICAgIAogICAgICAgIGlmIGlzSW5BRktXb3JsZCB0aGVuCiAgICAgICAgICAgIEZsdWVudDpOb3RpZnkoewogICAgICAgICAgICAgICAgVGl0bGUgPSAiQUZLV29ybGQiLAogICAgICAgICAgICAgICAgQ29udGVudCA9ICJC4bqhbiDEkcOjIOG7nyB0cm9uZyBBRktXb3JsZCIsCiAgICAgICAgICAgICAgICBEdXJhdGlvbiA9IDIKICAgICAgICAgICAgfSkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgam9pbkFGS1dvcmxkKCkKICAgICAgICAKICAgICAgICBGbHVlbnQ6Tm90aWZ5KHsKICAgICAgICAgICAgVGl0bGUgPSAiQUZLV29ybGQiLAogICAgICAgICAgICBDb250ZW50ID0gIsSQYW5nIHRlbGVwb3J0IMSR4bq/biBBRktXb3JsZC4uLiIsCiAgICAgICAgICAgIER1cmF0aW9uID0gMgogICAgICAgIH0pCiAgICBlbmQKfSkKCi0tIFThu7EgxJHhu5luZyDEkeG7k25nIGLhu5kgdHLhuqFuZyB0aMOhaSB04burIGdhbWUga2hpIGto4bufaSDEkeG7mW5nCnNwYXduKGZ1bmN0aW9uKCkKICAgIHdhaXQoMykgLS0gxJDhu6NpIGdhbWUgbG9hZAogICAgCiAgICAtLSBLaeG7g20gdHJhIG7hur91IG5nxrDhu51pIGNoxqFpIMSRw6Mg4bufIHRyb25nIEFGS1dvcmxkCiAgICBsb2NhbCBpc0luQUZLV29ybGQgPSBjaGVja0FGS1dvcmxkU3RhdGUoKQogICAgCiAgICAtLSBO4bq/dSBBdXRvIEpvaW4gQUZLIMSRxrDhu6NjIGLhuq10IHbDoCBuZ8aw4budaSBjaMahaSBraMO0bmcg4bufIHRyb25nIEFGS1dvcmxkCiAgICBpZiBhdXRvSm9pbkFGS0VuYWJsZWQgYW5kIG5vdCBpc0luQUZLV29ybGQgdGhlbgogICAgICAgIGpvaW5BRktXb3JsZCgpCiAgICBlbmQKZW5kKQo=
]]

-- Main execution
if not securityCheck() then
    warn("Bạn không có quyền sử dụng script này!")
    return
end

if not isExecutorSupported() then
    warn("Executor này có thể không được hỗ trợ đầy đủ.")
    wait(1)
end

-- Thực thi script
local success, err = pcall(function()
    loadstring(dec(encryptedScript))()
end)

if not success then
    warn("Lỗi khi chạy script: " .. tostring(err))
end
